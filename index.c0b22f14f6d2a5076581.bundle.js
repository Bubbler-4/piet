"use strict";
(self["webpackChunkpiet"] = self["webpackChunkpiet"] || []).push([["index"],{

/***/ "./node_modules/css-loader/dist/cjs.js!./src/index.css":
/*!*************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./src/index.css ***!
  \*************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/sourceMaps.js */ "./node_modules/css-loader/dist/runtime/sourceMaps.js");
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);
// Imports


var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));
// Module
___CSS_LOADER_EXPORT___.push([module.id, "svg {\n    margin: none;\n    padding: 2px;\n    border: 2px solid #ccc;\n}\n\n#svg-palette {\n    width: 368px;\n    height: 128px;\n}\n\ntextarea {\n    resize: none;\n    font-family: monospace;\n    white-space: pre-wrap;\n    overflow: hidden;\n}", "",{"version":3,"sources":["webpack://./src/index.css"],"names":[],"mappings":"AAAA;IACI,YAAY;IACZ,YAAY;IACZ,sBAAsB;AAC1B;;AAEA;IACI,YAAY;IACZ,aAAa;AACjB;;AAEA;IACI,YAAY;IACZ,sBAAsB;IACtB,qBAAqB;IACrB,gBAAgB;AACpB","sourcesContent":["svg {\n    margin: none;\n    padding: 2px;\n    border: 2px solid #ccc;\n}\n\n#svg-palette {\n    width: 368px;\n    height: 128px;\n}\n\ntextarea {\n    resize: none;\n    font-family: monospace;\n    white-space: pre-wrap;\n    overflow: hidden;\n}"],"sourceRoot":""}]);
// Exports
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);


/***/ }),

/***/ "./src/index.css":
/*!***********************!*\
  !*** ./src/index.css ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleDomAPI.js */ "./node_modules/style-loader/dist/runtime/styleDomAPI.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertBySelector.js */ "./node_modules/style-loader/dist/runtime/insertBySelector.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js */ "./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertStyleElement.js */ "./node_modules/style-loader/dist/runtime/insertStyleElement.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleTagTransform.js */ "./node_modules/style-loader/dist/runtime/styleTagTransform.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! !!../node_modules/css-loader/dist/cjs.js!./index.css */ "./node_modules/css-loader/dist/cjs.js!./src/index.css");

      
      
      
      
      
      
      
      
      

var options = {};

options.styleTagTransform = (_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default());
options.setAttributes = (_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default());

      options.insert = _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default().bind(null, "head");
    
options.domAPI = (_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default());
options.insertStyleElement = (_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default());

var update = _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"], options);




       /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"] && _node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals ? _node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals : undefined);


/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var bootstrap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bootstrap */ "./node_modules/bootstrap/dist/js/bootstrap.esm.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! snapsvg */ "./node_modules/snapsvg/dist/snap.svg.js");
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(snapsvg__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _piet_ui_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./piet-ui.js */ "./src/piet-ui.js");
/* harmony import */ var bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! bootstrap/dist/css/bootstrap.min.css */ "./node_modules/bootstrap/dist/css/bootstrap.min.css");
/* harmony import */ var bootstrap_icons_font_bootstrap_icons_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bootstrap-icons/font/bootstrap-icons.css */ "./node_modules/bootstrap-icons/font/bootstrap-icons.css");
/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./index.css */ "./src/index.css");








function init() {
  const ui = new _piet_ui_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
}

window.onload = () => {
  init();
  console.log('loaded');
};


/***/ }),

/***/ "./src/piet-run.js":
/*!*************************!*\
  !*** ./src/piet-run.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ PietRun)
/* harmony export */ });
/* harmony import */ var _piet_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./piet.js */ "./src/piet.js");


function divmod(x, y) {
  if ((x >= 0n && y > 0n) || (x < 0n && y < 0n)) {
    return [x / y, x % y];
  }
  const xabs = x >= 0n ? x : -x;
  const [yabs, ysgn] = y >= 0n ? [y, 1n] : [-y, -1n];
  let div = xabs / yabs;
  let mod = xabs % yabs;
  if (mod !== 0n) {
    div += 1n;
    mod = yabs - mod;
  }
  return [-div, mod * ysgn];
}

class PietRun {
  static {
    this.rOff = [0, 1, 0, -1];
    this.cOff = [1, 0, -1, 0];
    this.dpText = ['Right', 'Down', 'Left', 'Up'];
    this.ccText = [
      'Top',
      'Bottom',
      'Right',
      'Left',
      'Bottom',
      'Top',
      'Left',
      'Right',
    ];
    this.cmds = {
      push: (self, size) => {
        self.stack.push(BigInt(size));
        self.lastCmd = `push ${size}`;
      },
      pop: self => {
        self.stack.pop();
      },
      '+': self => {
        if (self.stack.length >= 2) {
          const [top2, top] = self.stack.splice(-2);
          self.stack.push(top2 + top);
        }
      },
      '-': self => {
        if (self.stack.length >= 2) {
          const [top2, top] = self.stack.splice(-2);
          self.stack.push(top2 - top);
        }
      },
      '*': self => {
        if (self.stack.length >= 2) {
          const [top2, top] = self.stack.splice(-2);
          self.stack.push(top2 * top);
        }
      },
      '/': self => {
        if (
          self.stack.length >= 2 &&
          self.stack[self.stack.length - 1] !== 0n
        ) {
          const [top2, top] = self.stack.splice(-2);
          self.stack.push(divmod(top2, top)[0]);
        }
      },
      '%': self => {
        if (
          self.stack.length >= 2 &&
          self.stack[self.stack.length - 1] !== 0n
        ) {
          const [top2, top] = self.stack.splice(-2);
          self.stack.push(divmod(top2, top)[1]);
        }
      },
      '!': self => {
        if (self.stack.length >= 1) {
          const top = self.stack.pop();
          self.stack.push(top === 0n ? 1n : 0n);
        }
      },
      '>': self => {
        if (self.stack.length >= 2) {
          const [top2, top] = self.stack.splice(-2);
          self.stack.push(top2 > top ? 1n : 0n);
        }
      },
      'DP+': self => {
        if (self.stack.length >= 1) {
          const top = self.stack.pop();
          self.dp = (self.dp + Number(top % 4n) + 4) % 4;
        }
      },
      'CC+': self => {
        if (self.stack.length >= 1) {
          const top = self.stack.pop();
          self.cc = (self.cc + Number(top % 2n) + 2) % 2;
        }
      },
      dup: self => {
        if (self.stack.length >= 1) {
          const top = self.stack.pop();
          self.stack.push(top, top);
        }
      },
      roll: self => {
        if (self.stack.length >= 2) {
          const [top2, top] = self.stack.splice(-2);
          if (top2 >= 0n && self.stack.length >= Number(top2)) {
            const rot = divmod(-top, top2)[1];
            const removed = self.stack.splice(-Number(top2), Number(rot));
            self.stack.push(...removed);
          } else {
            self.stack.push(top2, top);
          }
        }
      },
      inN: self => {
        // skip whitespaces, accept digits and stop before non-digits
        // if no digits found, no-op
        const spaces = self.input.match(/^\s*/)[0];
        self.input = self.input.slice(spaces.length);
        const number = self.input.match(/^[0-9]*/)[0];
        if (number.length > 0) {
          self.stack.push(BigInt(number));
          self.input = self.input.slice(number.length);
        }
      },
      inC: self => {
        if (self.input !== '') {
          const cp = self.input.codePointAt(0);
          if (cp >= 65536) {
            self.input = self.input.slice(2);
          } else {
            self.input = self.input.slice(1);
          }
          self.stack.push(BigInt(cp));
        }
      },
      outN: self => {
        if (self.stack.length >= 1) {
          const top = self.stack.pop();
          self.output += top.toString();
        }
      },
      outC: self => {
        if (self.stack.length >= 1) {
          const top = self.stack.pop();
          if (top >= 0n && top <= 1114111n) {
            self.output += String.fromCodePoint(Number(top));
          }
        }
      },
    };
  }

  constructor(code, input) {
    this.dp = 0;
    this.cc = 0;
    this.curR = 0;
    this.curC = 0;
    this.lastCmd = 'N/A';
    this.lastChange = 'none';
    this.input = input;
    this.output = '';
    this.stack = [];
    this.tryHistory = [];
    this.finished = false;
    const rows = code.length;
    const cols = code[0].length;
    // for each cell (except black): reference to area object
    // for each area: list of cells, frontier cell for each dp and cc
    // white is 1 area per cell
    this.areas = [];
    for (let r = 0; r < rows; r += 1) {
      const areasRow = [];
      for (let c = 0; c < cols; c += 1) {
        areasRow.push(undefined);
      }
      this.areas.push(areasRow);
    }
    for (let r = 0; r < rows; r += 1) {
      for (let c = 0; c < cols; c += 1) {
        const curColor = code[r][c];
        if (this.areas[r][c] === undefined && curColor !== 19) {
          const newArea = {
            cells: [],
            color: curColor,
            frontier: [0, 0, 0, 0, 0, 0, 0, 0],
            frontierOut: [0, 0, 0, 0, 0, 0, 0, 0],
            frontierBlocked: Array(8).fill(false),
          };
          const stack = [[r, c]];
          while (stack.length !== 0) {
            const [curR, curC] = stack.pop();
            if (this.areas[curR][curC] === undefined) {
              this.areas[curR][curC] = newArea;
              newArea.cells.push([curR, curC]);
              [
                [curR - 1, curC],
                [curR, curC - 1],
                [curR + 1, curC],
                [curR, curC + 1],
              ].forEach(([nextR, nextC]) => {
                if (
                  nextR >= 0 &&
                  nextR < rows &&
                  nextC >= 0 &&
                  nextC < cols &&
                  code[nextR][nextC] === curColor &&
                  curColor !== 18
                ) {
                  stack.push([nextR, nextC]);
                }
              });
            }
          }
          // frontier calculation (right x2, down x2, left x2, up x2)
          for (let i = 0; i < 8; i += 1) {
            newArea.frontier[i] = [r, c];
          }
          newArea.cells.forEach(([curR, curC]) => {
            const conds = [
              ([fr, fc]) => curC > fc || (curC === fc && curR < fr),
              ([fr, fc]) => curC > fc || (curC === fc && curR > fr),
              ([fr, fc]) => curR > fr || (curR === fr && curC > fc),
              ([fr, fc]) => curR > fr || (curR === fr && curC < fc),
              ([fr, fc]) => curC < fc || (curC === fc && curR > fr),
              ([fr, fc]) => curC < fc || (curC === fc && curR < fr),
              ([fr, fc]) => curR < fr || (curR === fr && curC < fc),
              ([fr, fc]) => curR < fr || (curR === fr && curC > fc),
            ];
            conds.forEach((cond, i) => {
              const front = newArea.frontier[i];
              if (cond(front)) {
                newArea.frontier[i] = [curR, curC];
              }
            });
          });
          for (let i = 0; i < 8; i += 1) {
            const [fr, fc] = newArea.frontier[i];
            const outR = fr + PietRun.rOff[(i / 2) | 0];
            const outC = fc + PietRun.cOff[(i / 2) | 0];
            newArea.frontierOut[i] = [outR, outC];
            newArea.frontierBlocked[i] =
              outR < 0 ||
              outR >= rows ||
              outC < 0 ||
              outC >= cols ||
              code[outR][outC] === 19;
          }
        }
      }
    }
    const startArea = this.areas[0][0];
    [this.curR, this.curC] = startArea.frontier[this.dp * 2 + this.cc];
  }

  step() {
    const cycleDetected = this.tryHistory.some(
      ([r, c, dp, cc]) =>
        this.curR === r && this.curC === c && this.dp === dp && this.cc === cc,
    );
    if (cycleDetected) {
      this.finished = true;
      return;
    }
    const curArea = this.areas[this.curR][this.curC];
    const { color, frontierOut, frontierBlocked } = curArea;
    const [nextR, nextC] = frontierOut[this.dp * 2 + this.cc];
    const blocked = frontierBlocked[this.dp * 2 + this.cc];
    if (blocked) {
      this.tryHistory.push([this.curR, this.curC, this.dp, this.cc]);
      if (this.lastChange === 'cc') {
        this.dp = (this.dp + 1) & 3;
        this.lastChange = 'dp';
      } else {
        this.cc = 1 - this.cc;
        this.lastChange = 'cc';
      }
      [this.curR, this.curC] = curArea.frontier[this.dp * 2 + this.cc];
      this.lastCmd = 'blocked';
      // console.log('blocked');
    } else {
      this.lastChange = 'none';
      if (color === 18) {
        this.tryHistory.push([this.curR, this.curC, this.dp, this.cc]);
        const nextArea = this.areas[nextR][nextC];
        [this.curR, this.curC] = nextArea.frontier[this.dp * 2 + this.cc];
        this.lastCmd = 'noop';
        // console.log('noop');
      } else {
        this.tryHistory.length = 0;
        const nextArea = this.areas[nextR][nextC];
        [this.curR, this.curC] = nextArea.frontier[this.dp * 2 + this.cc];
        const nextColor = nextArea.color;
        if (nextColor === 18) {
          this.lastCmd = 'noop';
          // console.log('noop');
        } else {
          const lightDiff = (((nextColor / 6 + 3) | 0) - ((color / 6) | 0)) % 3;
          const hueDiff = ((nextColor % 6) + 6 - (color % 6)) % 6;
          this.lastCmd = _piet_js__WEBPACK_IMPORTED_MODULE_0__["default"].commandText[lightDiff][hueDiff];
          // console.log('cmd:', lightDiff, hueDiff, this.lastCmd);
          PietRun.cmds[this.lastCmd](this, curArea.cells.length);
          [this.curR, this.curC] = nextArea.frontier[this.dp * 2 + this.cc];
        }
      }
    }
  }
}


/***/ }),

/***/ "./src/piet-ui.js":
/*!************************!*\
  !*** ./src/piet-ui.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ PietUI)
/* harmony export */ });
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! snapsvg */ "./node_modules/snapsvg/dist/snap.svg.js");
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(snapsvg__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _piet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./piet.js */ "./src/piet.js");
/* harmony import */ var _piet_run_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./piet-run.js */ "./src/piet-run.js");





function adjustHeight() {
  this.style.height = 'auto';
  this.style.height = `${this.scrollHeight}px`;
}

class PietUI {
  constructor(code) {
    jquery__WEBPACK_IMPORTED_MODULE_1___default()('textarea')
      .each(function setAttr() {
        this.setAttribute(
          'style',
          `height:${this.scrollHeight}px;overflow-y:hidden;`,
        );
      })
      .on('input', adjustHeight);

    this.paletteSvg = snapsvg__WEBPACK_IMPORTED_MODULE_0___default()('#svg-palette');
    this.paletteRects = [];
    this.paletteOverlays = [];
    for (let light = 0; light < 3; light += 1) {
      this.paletteOverlays.push([]);
      for (let hue = 0; hue < 6; hue += 1) {
        const color = light * 6 + hue;
        const curRect = this.paletteSvg.el('rect', {
          width: 60,
          height: 30,
          x: 60 * hue,
          y: 30 * light,
          fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[color].colorcode,
        });
        this.paletteRects.push(curRect);
        const curCmd = this.paletteSvg
          .text(60 * hue + 30, 30 * light + 15, '')
          .attr({
            'text-anchor': 'middle',
            'dominant-baseline': 'middle',
            'pointer-events': 'none',
          });
        if (hue === 4 && light >= 1) {
          curCmd.attr({ fill: 'white' });
        } else {
          curCmd.attr({ fill: 'black' });
        }
        this.paletteOverlays[light].push(curCmd);
        this.paletteSvg.g(curRect, curCmd).click(e => {
          e.stopPropagation();
          e.preventDefault();
          console.log(e);
          console.log(color);
          this.edit.updateColor(color);
        });
      }
    }
    for (let color = 18; color <= 19; color += 1) {
      const curRect = this.paletteSvg
        .el('rect', {
          width: 180,
          height: 30,
          x: 180 * (color - 18),
          y: 90,
          fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[color].colorcode,
        })
        .click(e => {
          e.stopPropagation();
          e.preventDefault();
          console.log(e);
          console.log(color);
          this.edit.updateColor(color);
        });
      this.paletteRects.push(curRect);
    }
    this.codeSvg = snapsvg__WEBPACK_IMPORTED_MODULE_0___default()('#svg-code');
    this.code = new _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"](code);
    const codeRect = this.codeSvg
      .el('rect', { width: 30, height: 30 })
      .toDefs();
    this.codeRects = [[]];
    this.codeRects.update = () => {
      let prevRows = this.codeRects.length;
      let prevCols = this.codeRects[0].length;
      while (prevCols < this.code.cols) {
        const c = prevCols;
        this.codeRects.forEach((row, r) => {
          const newRect = this.codeSvg.use(codeRect);
          newRect.attr({
            x: 30 * c,
            y: 30 * r,
            fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[this.code.code[r][c]].colorcode,
          });
          row.push(newRect);
        });
        prevCols += 1;
      }
      while (prevCols > this.code.cols) {
        this.codeRects.forEach(row => row.pop().remove());
        prevCols -= 1;
      }
      while (prevRows < this.code.rows) {
        const r = prevRows;
        const newRow = this.code.code[r].map((color, c) => {
          const curRect = this.codeSvg.use(codeRect);
          return curRect.attr({
            x: 30 * c,
            y: 30 * r,
            fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[color].colorcode,
          });
        });
        this.codeRects.push(newRow);
        prevRows += 1;
      }
      while (prevRows > this.code.rows) {
        this.codeRects.pop().forEach(rect => rect.remove());
        prevRows -= 1;
      }
      this.codeRects.forEach((row, r) => {
        row.forEach((rect, c) => {
          rect.attr({ fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[this.code.code[r][c]].colorcode });
        });
      });
      this.codeSvg.attr({
        width: 30 * this.code.cols + 8,
        height: 30 * this.code.rows + 8,
      });
    };
    this.codeRects.update();
    this.edit = {
      mode: 'write',
      color: 0,
      selectColor: clr => {
        this.paletteRects[clr].attr({
          stroke: 'gray',
          'stroke-width': 6,
          x: '+=3',
          y: '+=3',
          width: '-=6',
          height: '-=6',
        });
        if (clr < 18) {
          const curHue = clr % 6;
          const curLight = (clr / 6) | 0;
          for (let lightOff = 0; lightOff < 3; lightOff += 1) {
            for (let hueOff = 0; hueOff < 6; hueOff += 1) {
              const s = _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].commandText[lightOff][hueOff];
              const nextHue = (curHue + hueOff) % 6;
              const nextLight = (curLight + lightOff) % 3;
              this.paletteOverlays[nextLight][nextHue].node.textContent = s;
            }
          }
        } else {
          for (let light = 0; light < 3; light += 1) {
            for (let hue = 0; hue < 6; hue += 1) {
              this.paletteOverlays[light][hue].node.textContent = '';
            }
          }
        }
      },
      unselectColor: clr => {
        this.paletteRects[clr].attr({
          stroke: undefined,
          'stroke-width': undefined,
          x: '-=3',
          y: '-=3',
          width: '+=6',
          height: '+=6',
        });
      },
      updateColor: clr => {
        const prevColor = this.edit.color;
        this.edit.color = clr;
        this.edit.unselectColor(prevColor);
        this.edit.selectColor(clr);
      },
      updateCodeColor1: (r, c, clr) => {
        this.code.code[r][c] = clr;
        this.codeRects[r][c].attr({ fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[clr].colorcode });
      },
    };
    this.edit.selectColor(0);

    ['l', 'u', 'r', 'd'].forEach(direction => {
      ['plus', 'minus'].forEach(action => {
        const id = `#grid-${direction}${action}`;
        const button = jquery__WEBPACK_IMPORTED_MODULE_1___default()(id);
        button.on('click', e => {
          e.stopPropagation();
          e.preventDefault();
          if (action === 'plus') {
            this.code.extendCode(direction);
          } else {
            this.code.shrinkCode(direction);
          }
          this.codeRects.update();
        });
      });
    });

    const writeButton = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#grid-write');
    const pickButton = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#grid-pick');
    writeButton.on('click', () => {
      this.codeSvg.unclick();
      this.codeSvg.drag(
        (dx, dy, x, y, e) => {
          const curR = ((e.offsetY - 3) / 30) | 0;
          const curC = ((e.offsetX - 3) / 30) | 0;
          if (
            curR >= 0 &&
            curR < this.code.rows &&
            curC >= 0 &&
            curC < this.code.cols
          ) {
            this.edit.updateCodeColor1(curR, curC, this.edit.color);
          }
        },
        (x, y, e) => {
          const curR = ((e.offsetY - 3) / 30) | 0;
          const curC = ((e.offsetX - 3) / 30) | 0;
          if (
            curR >= 0 &&
            curR < this.code.rows &&
            curC >= 0 &&
            curC < this.code.cols
          ) {
            this.edit.updateCodeColor1(curR, curC, this.edit.color);
          }
        },
        () => {},
      );
    });
    pickButton.on('click', () => {
      this.codeSvg.undrag();
      this.codeSvg.click(e => {
        const curR = ((e.offsetY - 3) / 30) | 0;
        const curC = ((e.offsetX - 3) / 30) | 0;
        if (
          curR >= 0 &&
          curR < this.code.rows &&
          curC >= 0 &&
          curC < this.code.cols
        ) {
          this.edit.updateColor(this.code.code[curR][curC]);
        }
      });
    });
    writeButton.trigger('click');

    this.export = {
      pngButton: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#export-png'),
      svgButton: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#export-svg'),
      asciiGrid: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#export-ascii-grid'),
      asciiMini: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#export-ascii-mini'),
      shareContent: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#share-content'),
      updateExportLink: () => {
        const { rows, cols } = this.code;
        const matrix = this.code.code;
        const canvas = jquery__WEBPACK_IMPORTED_MODULE_1___default()('<canvas/>');
        canvas.prop({ width: cols, height: rows });
        const canvasEl = canvas.get(0);
        const ctx = canvasEl.getContext('2d');
        const imdata = ctx.getImageData(0, 0, cols, rows);
        for (let r = 0; r < rows; r += 1) {
          for (let c = 0; c < cols; c += 1) {
            const idx = (r * cols + c) * 4;
            const { colorvec } = _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[matrix[r][c]];
            for (let i = 0; i < 4; i += 1) {
              imdata.data[idx + i] = colorvec[i];
            }
          }
        }
        ctx.putImageData(imdata, 0, 0);
        canvasEl.toBlob(blob => {
          const pngUrl = URL.createObjectURL(blob);
          this.export.pngButton.prop({ href: pngUrl });
        });
        // const pngUrl = canvasEl.toDataURL('image/png');
        // this.export.pngButton.prop({ href: pngUrl });
        const svgStr = this.codeSvg
          .outerSVG()
          .replace('<svg', '<svg xmlns="http://www.w3.org/2000/svg"');
        const svgBlob = new Blob([svgStr]);
        const svgUrl = URL.createObjectURL(svgBlob);
        this.export.svgButton.prop({ href: svgUrl });
      },
    };
    jquery__WEBPACK_IMPORTED_MODULE_1___default()('#nav-share-tab').on('click', () => {
      this.export.updateExportLink();
    });
    this.export.asciiGrid.on('click', () => {
      const ap = this.code.toAsciiPiet(false);
      this.export.shareContent.val(ap);
      adjustHeight.call(this.export.shareContent.get(0));
    });
    this.export.asciiMini.on('click', () => {
      const ap = this.code.toAsciiPiet(true);
      this.export.shareContent.val(ap);
      adjustHeight.call(this.export.shareContent.get(0));
    });

    this.import = {
      fileButton: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#import-file'),
      fileInputButton: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#import-file-input'),
      asciiButton: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#import-ascii'),
      asciiText: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#share-content'),
    };
    this.import.asciiButton.on('click', () => {
      const ascii = this.import.asciiText.val();
      const codeGrid = _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].fromAsciiPiet(ascii);
      console.log(codeGrid);
      this.code.replaceCode(codeGrid);
      this.codeRects.update();
    });
    this.import.fileButton.on('click', () =>
      this.import.fileInputButton.trigger('click'),
    );
    this.import.fileInputButton.on('change', e => {
      const file = e.target.files[0];
      const url = URL.createObjectURL(file);
      const img = new Image();
      img.onload = () => {
        URL.revokeObjectURL(url);
        let width = img.naturalWidth;
        let height = img.naturalHeight;
        const canvas = jquery__WEBPACK_IMPORTED_MODULE_1___default()('<canvas/>');
        canvas.prop({ width, height });
        const canvasEl = canvas.get(0);
        const ctx = canvasEl.getContext('2d');
        ctx.drawImage(img, 0, 0);
        const imdata = ctx.getImageData(0, 0, width, height);
        const codeGrid = [];
        if (width === 0 || height === 0) {
          codeGrid.push([19]); // fallback to single black cell
          width = 1;
          height = 1;
        } else {
          for (let r = 0; r < height; r += 1) {
            codeGrid.push([]);
            for (let c = 0; c < width; c += 1) {
              const idx = r * width * 4 + c * 4;
              const color =
                _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colorvec2color[imdata.data.slice(idx, idx + 4)] ?? 19;
              codeGrid[r].push(color);
            }
          }
        }
        const codeGrid2 = _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].compress(codeGrid, width, height);
        this.code.replaceCode(codeGrid2);
        this.codeRects.update();
      };
      img.src = url;
    });

    jquery__WEBPACK_IMPORTED_MODULE_1___default()('#nav-debug-tab').on('click', () => {
      const codeGrid = this.code.code;
      const startEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-start');
      const stepEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-step');
      const resetEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-reset');
      const inputEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-input');
      const outputEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-output');
      const stackEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-stack');
      const statusEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-status');
      const dpEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-dp');
      const ccEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-cc');
      const cmdEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-cmd');
      const speedEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-speed');
      const runEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-run');
      const pauseEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-pause');
      startEl.off('click');
      stepEl.off('click');
      resetEl.off('click');
      runEl.off('click');
      pauseEl.off('click');
      let animationId;
      let animationStartTime;
      let animationSpeed;
      let animationSteps;
      let origInput;
      let arrowEl;
      const updateUi = () => {
        const { dp, cc, input, output, stack, lastCmd } = this.runner;
        const dpDesc = _piet_run_js__WEBPACK_IMPORTED_MODULE_3__["default"].dpText[dp];
        const ccDesc = _piet_run_js__WEBPACK_IMPORTED_MODULE_3__["default"].ccText[dp * 2 + cc];
        dpEl.text(`${dp} (${dpDesc})`);
        ccEl.text(`${cc} (${ccDesc})`);
        inputEl.val(input);
        outputEl.val(output);
        const stackStr = stack.map(n => n.toString()).join(' ');
        stackEl.val(stackStr);
        adjustHeight.call(inputEl.get(0));
        adjustHeight.call(outputEl.get(0));
        adjustHeight.call(stackEl.get(0));
        cmdEl.text(lastCmd);
      };
      startEl.on('click', () => {
        outputEl.val('');
        adjustHeight.call(outputEl.get(0));
        if (codeGrid[0][0] === 19) {
          statusEl.text('Error: Starting black cell detected');
          dpEl.text('N/A');
          ccEl.text('N/A');
        } else {
          origInput = inputEl.val();
          this.runner = new _piet_run_js__WEBPACK_IMPORTED_MODULE_3__["default"](codeGrid, origInput);
          console.log(this.runner);
          startEl.prop('disabled', true);
          stepEl.prop('disabled', false);
          resetEl.prop('disabled', false);
          runEl.prop('disabled', false);
          inputEl.prop('readonly', true);
          statusEl.text('Running');
          updateUi();
          arrowEl = this.codeSvg.polygon(20, 5, 20, 25, 30, 15);
          arrowEl.attr({ fill: 'gray' });
          const mat = snapsvg__WEBPACK_IMPORTED_MODULE_0___default().matrix().translate(
            this.runner.curC * 30,
            this.runner.curR * 30,
          );
          arrowEl.transform(mat);
        }
      });
      stepEl.on('click', () => {
        console.log('step');
        statusEl.text('Running');
        this.runner.step();
        updateUi();
        const mat = snapsvg__WEBPACK_IMPORTED_MODULE_0___default().matrix()
          .translate(this.runner.curC * 30, this.runner.curR * 30)
          .rotate(this.runner.dp * 90, 15, 15);
        arrowEl.transform(mat);
        if (this.runner.finished) {
          stepEl.prop('disabled', true);
          statusEl.text('Finished');
          arrowEl.remove();
        }
      });
      runEl.on('click', () => {
        animationSpeed = Number(speedEl.val());
        if (
          Number.isSafeInteger(animationSpeed) &&
          animationSpeed > 0 &&
          animationSpeed <= 100
        ) {
          runEl.prop('disabled', true);
          pauseEl.prop('disabled', false);
          stepEl.prop('disabled', true);
          statusEl.text('Running');
          animationStartTime = performance.now();
          animationSteps = 0;
          const updateFrame = time => {
            animationId = requestAnimationFrame(updateFrame);
            const timeElapsed = time - animationStartTime;
            const nextSteps = Math.ceil((animationSpeed * timeElapsed) / 1000);
            for (; animationSteps < nextSteps; animationSteps += 1) {
              stepEl.trigger('click');
              if (this.runner.finished) {
                pauseEl.prop('disabled', true);
                cancelAnimationFrame(animationId);
                return;
              }
            }
          };
          animationId = requestAnimationFrame(updateFrame);
        } else {
          console.log('Invalid speed value');
          statusEl.text('Invalid speed value. Allowed values: 1 - 100');
        }
      });
      pauseEl.on('click', () => {
        runEl.prop('disabled', false);
        pauseEl.prop('disabled', true);
        stepEl.prop('disabled', false);
        cancelAnimationFrame(animationId);
      });
      resetEl.on('click', () => {
        console.log('reset');
        startEl.prop('disabled', false);
        stepEl.prop('disabled', true);
        resetEl.prop('disabled', true);
        inputEl.prop('readonly', false);
        inputEl.val(origInput);
        adjustHeight.call(inputEl.get(0));
        statusEl.text('N/A');
        dpEl.text('N/A');
        ccEl.text('N/A');
        cmdEl.text('N/A');
        if (arrowEl !== undefined) arrowEl.remove();
      });
    });
    jquery__WEBPACK_IMPORTED_MODULE_1___default()('#nav-edit-tab, #nav-test-tab, #nav-share-tab').on('click', () => {
      jquery__WEBPACK_IMPORTED_MODULE_1___default()('#debug-reset').trigger('click');
    });

    jquery__WEBPACK_IMPORTED_MODULE_1___default()('#nav-test-tab').on('click', () => {
      const sepEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-sep');
      const limitEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-limit');
      const runEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-run');
      const stopEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-stop');
      const escapeEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-escape');
      const statusEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-status');
      const inputEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-input');
      const outputEl = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#test-output');

      runEl.on('click', () => {
        const sep = sepEl.val() === '' ? '---' : sepEl.val();
        sepEl.val(sep);
        const limitVal = Number(limitEl.val());
        const limit =
          Number.isSafeInteger(limitVal) && limitVal > 0 ? limitVal : 10000;
        limitEl.val(limit);
        runEl.prop('disabled', true);
        stopEl.prop('disabled', false);
        inputEl.prop('readonly', true);
        const doEscape = escapeEl.prop('checked');
        let inputs = inputEl.val().split(`\n${sep}\n`);
        if (doEscape) {
          inputs = inputs.map(s =>
            s.replace(
              /\\[0'"\\nrvtbf]|\\u[0-9a-fA-F]{4}|\\u\{[0-9a-fA-F]+\}|\\x[0-9a-fA-F]{2}/g,
              match => {
                if (match.startsWith('\\u') || match.startsWith('\\x')) {
                  const hex = match.startsWith('\\u{')
                    ? match.slice(3, -1)
                    : match.slice(2);
                  return String.fromCodePoint(Number.parseInt(hex, 16));
                }
                return {
                  '\\0': '\0',
                  "\\'": "'",
                  '\\"': '"',
                  '\\\\': '\\',
                  '\\n': '\n',
                  '\\r': '\r',
                  '\\v': '\v',
                  '\\t': '\t',
                  '\\b': '\b',
                  '\\f': '\f',
                }[match];
              },
            ),
          );
        }
        const runners = inputs.map(input => new _piet_run_js__WEBPACK_IMPORTED_MODULE_3__["default"](this.code.code, input));
        const stepsPerRunner = runners.map(() => 0);
        let alive = runners.length;
        const steps = 10; // steps per ms
        const startTime = performance.now();
        let stepsRun = 0;
        let runId;
        statusEl.text('Running');
        const update = time => {
          if (alive === 0) {
            stopEl.trigger('click');
            return;
          }
          runId = requestAnimationFrame(update);
          const totalSteps = Math.ceil(steps * (time - startTime));
          const singleSteps = Math.round((totalSteps - stepsRun) / alive);
          runners.forEach((runner, i) => {
            if (runner.finished) return;
            for (let s = 0; s < singleSteps; s += 1) {
              runner.step();
              stepsRun += 1;
              stepsPerRunner[i] += 1;
              if (stepsPerRunner[i] >= limit) {
                runner.finished = true;
              }
              if (runner.finished) {
                alive -= 1;
                break;
              }
            }
          });
        };
        stopEl.one('click', () => {
          cancelAnimationFrame(runId);
          const outputs = runners.map(runner => runner.output);
          runners.forEach((runner, i) => {
            if (!runner.finished) {
              outputs[i] += '\n** Aborted';
            } else if (stepsPerRunner[i] >= limit) {
              outputs[i] += '\n** Exceeded Step Limit';
            }
          });
          outputEl.val(outputs.join('\n---\n'));
          adjustHeight.call(outputEl.get(0));
          statusEl.text('Finished');
          stopEl.prop('disabled', true);
          runEl.prop('disabled', false);
          inputEl.prop('readonly', false);
        });
        runId = requestAnimationFrame(update);
      });
    });
  }
}


/***/ }),

/***/ "./src/piet.js":
/*!*********************!*\
  !*** ./src/piet.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Piet)
/* harmony export */ });
class Piet {
  static commandText = [
    ['', '+', '/', '>', 'dup', 'inC'],
    ['push', '-', '%', 'DP+', 'roll', 'outN'],
    ['pop', '*', '!', 'CC+', 'inN', 'outC'],
  ];

  static {
    this.char2color = {};
    this.colorvec2color = {};
    this.colors = [];
    const hueMask = [4, 6, 2, 3, 1, 5];
    const lightStr = [
      ['C0', 'FF'],
      ['00', 'FF'],
      ['00', 'C0'],
    ];
    for (let darkness = 0; darkness < 3; darkness += 1) {
      const light = lightStr[darkness];
      for (let hue = 0; hue < 6; hue += 1) {
        const charcode = darkness * 32 + hue + 48;
        let colorcode = '#';
        const colorvec = [];
        for (let i = 0; i < 3; i += 1) {
          const nextVal = light[(hueMask[hue] >> (2 - i)) & 1];
          colorcode += nextVal;
          colorvec.push(Number.parseInt(nextVal, 16));
        }
        colorvec.push(255);
        const char = String.fromCharCode(charcode);
        this.colors.push({ charcode, char, colorcode, colorvec });
        this.char2color[char] = darkness * 6 + hue;
        this.colorvec2color[colorvec] = darkness * 6 + hue;
      }
    }
    this.colors.push({
      charcode: '@'.charCodeAt(),
      char: '@',
      colorcode: '#FFFFFF',
      colorvec: [255, 255, 255, 255],
    });
    this.char2color['@'] = 18;
    this.colorvec2color[this.colors[18].colorvec] = 18;
    this.colors.push({
      charcode: ' '.charCodeAt(),
      char: ' ',
      colorcode: '#000000',
      colorvec: [0, 0, 0, 255],
    });
    this.char2color[' '] = 19;
    this.colorvec2color[this.colors[19].colorvec] = 19;
  }

  static compress(codeGrid, width, height) {
    function gcd(a, b) {
      let [x, y] = [a, b];
      while (y !== 0) {
        [x, y] = [y, x % y];
      }
      return x;
    }
    const g = gcd(width, height);
    function check(s) {
      for (let r = 0; r < height / s; r += 1) {
        for (let c = 0; c < width / s; c += 1) {
          const rmin = r * s;
          const rmax = (r + 1) * s;
          const cmin = c * s;
          const cmax = (c + 1) * s;
          const expected = codeGrid[rmin][cmin];
          for (let rr = rmin; rr < rmax; rr += 1) {
            for (let cc = cmin; cc < cmax; cc += 1) {
              if (expected !== codeGrid[rr][cc]) {
                return false;
              }
            }
          }
        }
      }
      return true;
    }
    for (let gg = g; gg >= 1; gg -= 1) {
      if (g % gg === 0) {
        if (check(gg)) {
          return codeGrid
            .filter((r, i) => i % gg === 0)
            .map(row => row.filter((c, i) => i % gg === 0));
        }
      }
    }
    return codeGrid;
  }

  static fromAsciiPiet(apcode) {
    const apgrid = apcode.replace(/[@A-Z_]/g, s => {
      if (s === '@') {
        return ' \n';
      }
      if (s === '_') {
        return '?\n';
      }
      return `${s.toLowerCase()}\n`;
    });
    const ap = 'tvrsqulnjkimdfbcae? ';
    const codeGrid = apgrid
      .split('\n')
      .map(s => [...s].map(c => (ap.indexOf(c) + 20) % 20));
    const cols = Math.max(1, ...codeGrid.map(row => row.length));
    codeGrid.forEach(row => {
      while (row.length < cols) {
        row.push(19);
      }
    });
    return codeGrid;
  }

  toAsciiPiet(compact) {
    const ap = 'tvrsqulnjkimdfbcae? ';
    const codeStr = this.code.map(row => {
      const rowStr = row
        .map(cell => ap[cell])
        .join('')
        .trimEnd();
      return rowStr;
    });
    if (!compact) {
      return codeStr.join('\n');
    }
    return codeStr
      .map((row, i) => {
        if (i === codeStr.length - 1) {
          return row;
        }
        const [front, back] = [row.slice(0, -1), row.slice(-1)];
        if (back === '?') {
          return `${front}_`;
        }
        return front + back.toUpperCase();
      })
      .join('');
  }

  constructor(code) {
    const codeStr = code || '0';
    this.code = codeStr
      .split(/\r?\n/)
      .map(row => [...row].map(cell => Piet.char2color[cell]));
    this.rows = this.code.length;
    this.cols = this.code[0].length;
  }

  extendCode(direction) {
    if (direction === 'r') {
      this.code.forEach(row => {
        row.push(19);
      });
      this.cols += 1;
    } else if (direction === 'l') {
      this.code.forEach(row => {
        row.unshift(19);
      });
      this.cols += 1;
    } else if (direction === 'd') {
      this.code.push(this.code[0].map(() => 19));
      this.rows += 1;
    } else if (direction === 'u') {
      this.code.unshift(this.code[0].map(() => 19));
      this.rows += 1;
    }
  }

  shrinkCode(direction) {
    if (
      ((direction === 'r' || direction === 'l') && this.cols === 1) ||
      ((direction === 'u' || direction === 'd') && this.rows === 1)
    ) {
      console.log('Dimension cannot be reduced from 1');
    } else if (direction === 'r') {
      this.code.forEach(row => {
        row.pop();
      });
      this.cols -= 1;
    } else if (direction === 'l') {
      this.code.forEach(row => {
        row.shift();
      });
      this.cols -= 1;
    } else if (direction === 'd') {
      this.code.pop();
      this.rows -= 1;
    } else if (direction === 'u') {
      this.code.shift();
      this.rows -= 1;
    }
  }

  replaceCode(newCode) {
    this.code = newCode;
    this.rows = this.code.length;
    this.cols = this.code[0].length;
  }
}


/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e":
/*!*********************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e ***!
  \*********************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e":
/*!***********************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e ***!
  \***********************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%230c63e4%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%230c63e4%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%230c63e4%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23212529%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23212529%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23212529%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e":
/*!************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e ***!
  \************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e":
/*!*************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e ***!
  \*************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M2 5l6 6 6-6%27/%3e%3c/svg%3e":
/*!****************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M2 5l6 6 6-6%27/%3e%3c/svg%3e ***!
  \****************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M2 5l6 6 6-6%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e":
/*!********************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e ***!
  \********************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10l3 3l6-6%27/%3e%3c/svg%3e":
/*!**************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10l3 3l6-6%27/%3e%3c/svg%3e ***!
  \**************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10l3 3l6-6%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%280, 0, 0, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e":
/*!************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%280, 0, 0, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e ***!
  \************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%280, 0, 0, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e":
/*!***********************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e ***!
  \***********************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e";

/***/ })

},
/******/ __webpack_require__ => { // webpackRuntimeModules
/******/ var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
/******/ __webpack_require__.O(0, ["vendors"], () => (__webpack_exec__("./src/index.js")));
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ }
]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguYzBiMjJmMTRmNmQyYTUwNzY1ODEuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDMEc7QUFDakI7QUFDekYsOEJBQThCLG1GQUEyQixDQUFDLDRGQUFxQztBQUMvRjtBQUNBLCtDQUErQyxtQkFBbUIsbUJBQW1CLDZCQUE2QixHQUFHLGtCQUFrQixtQkFBbUIsb0JBQW9CLEdBQUcsY0FBYyxtQkFBbUIsNkJBQTZCLDRCQUE0Qix1QkFBdUIsR0FBRyxPQUFPLGdGQUFnRixVQUFVLFVBQVUsWUFBWSxPQUFPLEtBQUssVUFBVSxVQUFVLE9BQU8sS0FBSyxVQUFVLFlBQVksYUFBYSxhQUFhLCtCQUErQixtQkFBbUIsbUJBQW1CLDZCQUE2QixHQUFHLGtCQUFrQixtQkFBbUIsb0JBQW9CLEdBQUcsY0FBYyxtQkFBbUIsNkJBQTZCLDRCQUE0Qix1QkFBdUIsR0FBRyxtQkFBbUI7QUFDaHlCO0FBQ0EsaUVBQWUsdUJBQXVCLEVBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDTnZDLE1BQStGO0FBQy9GLE1BQXFGO0FBQ3JGLE1BQTRGO0FBQzVGLE1BQStHO0FBQy9HLE1BQXdHO0FBQ3hHLE1BQXdHO0FBQ3hHLE1BQW1HO0FBQ25HO0FBQ0E7O0FBRUE7O0FBRUEsNEJBQTRCLHFHQUFtQjtBQUMvQyx3QkFBd0Isa0hBQWE7O0FBRXJDLHVCQUF1Qix1R0FBYTtBQUNwQztBQUNBLGlCQUFpQiwrRkFBTTtBQUN2Qiw2QkFBNkIsc0dBQWtCOztBQUUvQyxhQUFhLDBHQUFHLENBQUMsc0ZBQU87Ozs7QUFJNkM7QUFDckUsT0FBTyxpRUFBZSxzRkFBTyxJQUFJLDZGQUFjLEdBQUcsNkZBQWMsWUFBWSxFQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMxQnRDO0FBQ2hCO0FBQ0k7QUFDTztBQUNZO0FBQ0k7QUFDN0I7O0FBRXJCO0FBQ0EsaUJBQWlCLG1EQUFNO0FBQ3ZCOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7O0FDZjZCOztBQUU3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixLQUFLO0FBQ3BDLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE1BQU07QUFDMUI7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9waWV0Ly4vc3JjL2luZGV4LmNzcyIsIndlYnBhY2s6Ly9waWV0Ly4vc3JjL2luZGV4LmNzcz9jZmU0Iiwid2VicGFjazovL3BpZXQvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcGlldC8uL3NyYy9waWV0LXJ1bi5qcyIsIndlYnBhY2s6Ly9waWV0Ly4vc3JjL3BpZXQtdWkuanMiLCJ3ZWJwYWNrOi8vcGlldC8uL3NyYy9waWV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEltcG9ydHNcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fIGZyb20gXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvc291cmNlTWFwcy5qc1wiO1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyBmcm9tIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiO1xudmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKF9fX0NTU19MT0FERVJfQVBJX1NPVVJDRU1BUF9JTVBPUlRfX18pO1xuLy8gTW9kdWxlXG5fX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaWQsIFwic3ZnIHtcXG4gICAgbWFyZ2luOiBub25lO1xcbiAgICBwYWRkaW5nOiAycHg7XFxuICAgIGJvcmRlcjogMnB4IHNvbGlkICNjY2M7XFxufVxcblxcbiNzdmctcGFsZXR0ZSB7XFxuICAgIHdpZHRoOiAzNjhweDtcXG4gICAgaGVpZ2h0OiAxMjhweDtcXG59XFxuXFxudGV4dGFyZWEge1xcbiAgICByZXNpemU6IG5vbmU7XFxuICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XFxuICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcXG59XCIsIFwiXCIse1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wid2VicGFjazovLy4vc3JjL2luZGV4LmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQTtJQUNJLFlBQVk7SUFDWixZQUFZO0lBQ1osc0JBQXNCO0FBQzFCOztBQUVBO0lBQ0ksWUFBWTtJQUNaLGFBQWE7QUFDakI7O0FBRUE7SUFDSSxZQUFZO0lBQ1osc0JBQXNCO0lBQ3RCLHFCQUFxQjtJQUNyQixnQkFBZ0I7QUFDcEJcIixcInNvdXJjZXNDb250ZW50XCI6W1wic3ZnIHtcXG4gICAgbWFyZ2luOiBub25lO1xcbiAgICBwYWRkaW5nOiAycHg7XFxuICAgIGJvcmRlcjogMnB4IHNvbGlkICNjY2M7XFxufVxcblxcbiNzdmctcGFsZXR0ZSB7XFxuICAgIHdpZHRoOiAzNjhweDtcXG4gICAgaGVpZ2h0OiAxMjhweDtcXG59XFxuXFxudGV4dGFyZWEge1xcbiAgICByZXNpemU6IG5vbmU7XFxuICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XFxuICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcXG59XCJdLFwic291cmNlUm9vdFwiOlwiXCJ9XSk7XG4vLyBFeHBvcnRzXG5leHBvcnQgZGVmYXVsdCBfX19DU1NfTE9BREVSX0VYUE9SVF9fXztcbiIsIlxuICAgICAgaW1wb3J0IEFQSSBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiO1xuICAgICAgaW1wb3J0IGRvbUFQSSBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlRG9tQVBJLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0Rm4gZnJvbSBcIiEuLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRCeVNlbGVjdG9yLmpzXCI7XG4gICAgICBpbXBvcnQgc2V0QXR0cmlidXRlcyBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3NldEF0dHJpYnV0ZXNXaXRob3V0QXR0cmlidXRlcy5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydFN0eWxlRWxlbWVudCBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydFN0eWxlRWxlbWVudC5qc1wiO1xuICAgICAgaW1wb3J0IHN0eWxlVGFnVHJhbnNmb3JtRm4gZnJvbSBcIiEuLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZVRhZ1RyYW5zZm9ybS5qc1wiO1xuICAgICAgaW1wb3J0IGNvbnRlbnQsICogYXMgbmFtZWRFeHBvcnQgZnJvbSBcIiEhLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9pbmRleC5jc3NcIjtcbiAgICAgIFxuICAgICAgXG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuc3R5bGVUYWdUcmFuc2Zvcm0gPSBzdHlsZVRhZ1RyYW5zZm9ybUZuO1xub3B0aW9ucy5zZXRBdHRyaWJ1dGVzID0gc2V0QXR0cmlidXRlcztcblxuICAgICAgb3B0aW9ucy5pbnNlcnQgPSBpbnNlcnRGbi5iaW5kKG51bGwsIFwiaGVhZFwiKTtcbiAgICBcbm9wdGlvbnMuZG9tQVBJID0gZG9tQVBJO1xub3B0aW9ucy5pbnNlcnRTdHlsZUVsZW1lbnQgPSBpbnNlcnRTdHlsZUVsZW1lbnQ7XG5cbnZhciB1cGRhdGUgPSBBUEkoY29udGVudCwgb3B0aW9ucyk7XG5cblxuXG5leHBvcnQgKiBmcm9tIFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL2luZGV4LmNzc1wiO1xuICAgICAgIGV4cG9ydCBkZWZhdWx0IGNvbnRlbnQgJiYgY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHVuZGVmaW5lZDtcbiIsImltcG9ydCAqIGFzIGJvb3RzdHJhcCBmcm9tICdib290c3RyYXAnO1xuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCBTbmFwIGZyb20gJ3NuYXBzdmcnO1xuaW1wb3J0IFBpZXRVSSBmcm9tICcuL3BpZXQtdWkuanMnO1xuaW1wb3J0ICdib290c3RyYXAvZGlzdC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MnO1xuaW1wb3J0ICdib290c3RyYXAtaWNvbnMvZm9udC9ib290c3RyYXAtaWNvbnMuY3NzJztcbmltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG5mdW5jdGlvbiBpbml0KCkge1xuICBjb25zdCB1aSA9IG5ldyBQaWV0VUkoKTtcbn1cblxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgaW5pdCgpO1xuICBjb25zb2xlLmxvZygnbG9hZGVkJyk7XG59O1xuIiwiaW1wb3J0IFBpZXQgZnJvbSAnLi9waWV0LmpzJztcblxuZnVuY3Rpb24gZGl2bW9kKHgsIHkpIHtcbiAgaWYgKCh4ID49IDBuICYmIHkgPiAwbikgfHwgKHggPCAwbiAmJiB5IDwgMG4pKSB7XG4gICAgcmV0dXJuIFt4IC8geSwgeCAlIHldO1xuICB9XG4gIGNvbnN0IHhhYnMgPSB4ID49IDBuID8geCA6IC14O1xuICBjb25zdCBbeWFicywgeXNnbl0gPSB5ID49IDBuID8gW3ksIDFuXSA6IFsteSwgLTFuXTtcbiAgbGV0IGRpdiA9IHhhYnMgLyB5YWJzO1xuICBsZXQgbW9kID0geGFicyAlIHlhYnM7XG4gIGlmIChtb2QgIT09IDBuKSB7XG4gICAgZGl2ICs9IDFuO1xuICAgIG1vZCA9IHlhYnMgLSBtb2Q7XG4gIH1cbiAgcmV0dXJuIFstZGl2LCBtb2QgKiB5c2duXTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGlldFJ1biB7XG4gIHN0YXRpYyB7XG4gICAgdGhpcy5yT2ZmID0gWzAsIDEsIDAsIC0xXTtcbiAgICB0aGlzLmNPZmYgPSBbMSwgMCwgLTEsIDBdO1xuICAgIHRoaXMuZHBUZXh0ID0gWydSaWdodCcsICdEb3duJywgJ0xlZnQnLCAnVXAnXTtcbiAgICB0aGlzLmNjVGV4dCA9IFtcbiAgICAgICdUb3AnLFxuICAgICAgJ0JvdHRvbScsXG4gICAgICAnUmlnaHQnLFxuICAgICAgJ0xlZnQnLFxuICAgICAgJ0JvdHRvbScsXG4gICAgICAnVG9wJyxcbiAgICAgICdMZWZ0JyxcbiAgICAgICdSaWdodCcsXG4gICAgXTtcbiAgICB0aGlzLmNtZHMgPSB7XG4gICAgICBwdXNoOiAoc2VsZiwgc2l6ZSkgPT4ge1xuICAgICAgICBzZWxmLnN0YWNrLnB1c2goQmlnSW50KHNpemUpKTtcbiAgICAgICAgc2VsZi5sYXN0Q21kID0gYHB1c2ggJHtzaXplfWA7XG4gICAgICB9LFxuICAgICAgcG9wOiBzZWxmID0+IHtcbiAgICAgICAgc2VsZi5zdGFjay5wb3AoKTtcbiAgICAgIH0sXG4gICAgICAnKyc6IHNlbGYgPT4ge1xuICAgICAgICBpZiAoc2VsZi5zdGFjay5sZW5ndGggPj0gMikge1xuICAgICAgICAgIGNvbnN0IFt0b3AyLCB0b3BdID0gc2VsZi5zdGFjay5zcGxpY2UoLTIpO1xuICAgICAgICAgIHNlbGYuc3RhY2sucHVzaCh0b3AyICsgdG9wKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgICctJzogc2VsZiA9PiB7XG4gICAgICAgIGlmIChzZWxmLnN0YWNrLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgICAgY29uc3QgW3RvcDIsIHRvcF0gPSBzZWxmLnN0YWNrLnNwbGljZSgtMik7XG4gICAgICAgICAgc2VsZi5zdGFjay5wdXNoKHRvcDIgLSB0b3ApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgJyonOiBzZWxmID0+IHtcbiAgICAgICAgaWYgKHNlbGYuc3RhY2subGVuZ3RoID49IDIpIHtcbiAgICAgICAgICBjb25zdCBbdG9wMiwgdG9wXSA9IHNlbGYuc3RhY2suc3BsaWNlKC0yKTtcbiAgICAgICAgICBzZWxmLnN0YWNrLnB1c2godG9wMiAqIHRvcCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAnLyc6IHNlbGYgPT4ge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgc2VsZi5zdGFjay5sZW5ndGggPj0gMiAmJlxuICAgICAgICAgIHNlbGYuc3RhY2tbc2VsZi5zdGFjay5sZW5ndGggLSAxXSAhPT0gMG5cbiAgICAgICAgKSB7XG4gICAgICAgICAgY29uc3QgW3RvcDIsIHRvcF0gPSBzZWxmLnN0YWNrLnNwbGljZSgtMik7XG4gICAgICAgICAgc2VsZi5zdGFjay5wdXNoKGRpdm1vZCh0b3AyLCB0b3ApWzBdKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgICclJzogc2VsZiA9PiB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBzZWxmLnN0YWNrLmxlbmd0aCA+PSAyICYmXG4gICAgICAgICAgc2VsZi5zdGFja1tzZWxmLnN0YWNrLmxlbmd0aCAtIDFdICE9PSAwblxuICAgICAgICApIHtcbiAgICAgICAgICBjb25zdCBbdG9wMiwgdG9wXSA9IHNlbGYuc3RhY2suc3BsaWNlKC0yKTtcbiAgICAgICAgICBzZWxmLnN0YWNrLnB1c2goZGl2bW9kKHRvcDIsIHRvcClbMV0pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgJyEnOiBzZWxmID0+IHtcbiAgICAgICAgaWYgKHNlbGYuc3RhY2subGVuZ3RoID49IDEpIHtcbiAgICAgICAgICBjb25zdCB0b3AgPSBzZWxmLnN0YWNrLnBvcCgpO1xuICAgICAgICAgIHNlbGYuc3RhY2sucHVzaCh0b3AgPT09IDBuID8gMW4gOiAwbik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAnPic6IHNlbGYgPT4ge1xuICAgICAgICBpZiAoc2VsZi5zdGFjay5sZW5ndGggPj0gMikge1xuICAgICAgICAgIGNvbnN0IFt0b3AyLCB0b3BdID0gc2VsZi5zdGFjay5zcGxpY2UoLTIpO1xuICAgICAgICAgIHNlbGYuc3RhY2sucHVzaCh0b3AyID4gdG9wID8gMW4gOiAwbik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAnRFArJzogc2VsZiA9PiB7XG4gICAgICAgIGlmIChzZWxmLnN0YWNrLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgY29uc3QgdG9wID0gc2VsZi5zdGFjay5wb3AoKTtcbiAgICAgICAgICBzZWxmLmRwID0gKHNlbGYuZHAgKyBOdW1iZXIodG9wICUgNG4pICsgNCkgJSA0O1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgJ0NDKyc6IHNlbGYgPT4ge1xuICAgICAgICBpZiAoc2VsZi5zdGFjay5sZW5ndGggPj0gMSkge1xuICAgICAgICAgIGNvbnN0IHRvcCA9IHNlbGYuc3RhY2sucG9wKCk7XG4gICAgICAgICAgc2VsZi5jYyA9IChzZWxmLmNjICsgTnVtYmVyKHRvcCAlIDJuKSArIDIpICUgMjtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGR1cDogc2VsZiA9PiB7XG4gICAgICAgIGlmIChzZWxmLnN0YWNrLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgY29uc3QgdG9wID0gc2VsZi5zdGFjay5wb3AoKTtcbiAgICAgICAgICBzZWxmLnN0YWNrLnB1c2godG9wLCB0b3ApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcm9sbDogc2VsZiA9PiB7XG4gICAgICAgIGlmIChzZWxmLnN0YWNrLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgICAgY29uc3QgW3RvcDIsIHRvcF0gPSBzZWxmLnN0YWNrLnNwbGljZSgtMik7XG4gICAgICAgICAgaWYgKHRvcDIgPj0gMG4gJiYgc2VsZi5zdGFjay5sZW5ndGggPj0gTnVtYmVyKHRvcDIpKSB7XG4gICAgICAgICAgICBjb25zdCByb3QgPSBkaXZtb2QoLXRvcCwgdG9wMilbMV07XG4gICAgICAgICAgICBjb25zdCByZW1vdmVkID0gc2VsZi5zdGFjay5zcGxpY2UoLU51bWJlcih0b3AyKSwgTnVtYmVyKHJvdCkpO1xuICAgICAgICAgICAgc2VsZi5zdGFjay5wdXNoKC4uLnJlbW92ZWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLnN0YWNrLnB1c2godG9wMiwgdG9wKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbk46IHNlbGYgPT4ge1xuICAgICAgICAvLyBza2lwIHdoaXRlc3BhY2VzLCBhY2NlcHQgZGlnaXRzIGFuZCBzdG9wIGJlZm9yZSBub24tZGlnaXRzXG4gICAgICAgIC8vIGlmIG5vIGRpZ2l0cyBmb3VuZCwgbm8tb3BcbiAgICAgICAgY29uc3Qgc3BhY2VzID0gc2VsZi5pbnB1dC5tYXRjaCgvXlxccyovKVswXTtcbiAgICAgICAgc2VsZi5pbnB1dCA9IHNlbGYuaW5wdXQuc2xpY2Uoc3BhY2VzLmxlbmd0aCk7XG4gICAgICAgIGNvbnN0IG51bWJlciA9IHNlbGYuaW5wdXQubWF0Y2goL15bMC05XSovKVswXTtcbiAgICAgICAgaWYgKG51bWJlci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc2VsZi5zdGFjay5wdXNoKEJpZ0ludChudW1iZXIpKTtcbiAgICAgICAgICBzZWxmLmlucHV0ID0gc2VsZi5pbnB1dC5zbGljZShudW1iZXIubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGluQzogc2VsZiA9PiB7XG4gICAgICAgIGlmIChzZWxmLmlucHV0ICE9PSAnJykge1xuICAgICAgICAgIGNvbnN0IGNwID0gc2VsZi5pbnB1dC5jb2RlUG9pbnRBdCgwKTtcbiAgICAgICAgICBpZiAoY3AgPj0gNjU1MzYpIHtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQgPSBzZWxmLmlucHV0LnNsaWNlKDIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLmlucHV0ID0gc2VsZi5pbnB1dC5zbGljZSgxKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VsZi5zdGFjay5wdXNoKEJpZ0ludChjcCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3V0Tjogc2VsZiA9PiB7XG4gICAgICAgIGlmIChzZWxmLnN0YWNrLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgY29uc3QgdG9wID0gc2VsZi5zdGFjay5wb3AoKTtcbiAgICAgICAgICBzZWxmLm91dHB1dCArPSB0b3AudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG91dEM6IHNlbGYgPT4ge1xuICAgICAgICBpZiAoc2VsZi5zdGFjay5sZW5ndGggPj0gMSkge1xuICAgICAgICAgIGNvbnN0IHRvcCA9IHNlbGYuc3RhY2sucG9wKCk7XG4gICAgICAgICAgaWYgKHRvcCA+PSAwbiAmJiB0b3AgPD0gMTExNDExMW4pIHtcbiAgICAgICAgICAgIHNlbGYub3V0cHV0ICs9IFN0cmluZy5mcm9tQ29kZVBvaW50KE51bWJlcih0b3ApKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGNvZGUsIGlucHV0KSB7XG4gICAgdGhpcy5kcCA9IDA7XG4gICAgdGhpcy5jYyA9IDA7XG4gICAgdGhpcy5jdXJSID0gMDtcbiAgICB0aGlzLmN1ckMgPSAwO1xuICAgIHRoaXMubGFzdENtZCA9ICdOL0EnO1xuICAgIHRoaXMubGFzdENoYW5nZSA9ICdub25lJztcbiAgICB0aGlzLmlucHV0ID0gaW5wdXQ7XG4gICAgdGhpcy5vdXRwdXQgPSAnJztcbiAgICB0aGlzLnN0YWNrID0gW107XG4gICAgdGhpcy50cnlIaXN0b3J5ID0gW107XG4gICAgdGhpcy5maW5pc2hlZCA9IGZhbHNlO1xuICAgIGNvbnN0IHJvd3MgPSBjb2RlLmxlbmd0aDtcbiAgICBjb25zdCBjb2xzID0gY29kZVswXS5sZW5ndGg7XG4gICAgLy8gZm9yIGVhY2ggY2VsbCAoZXhjZXB0IGJsYWNrKTogcmVmZXJlbmNlIHRvIGFyZWEgb2JqZWN0XG4gICAgLy8gZm9yIGVhY2ggYXJlYTogbGlzdCBvZiBjZWxscywgZnJvbnRpZXIgY2VsbCBmb3IgZWFjaCBkcCBhbmQgY2NcbiAgICAvLyB3aGl0ZSBpcyAxIGFyZWEgcGVyIGNlbGxcbiAgICB0aGlzLmFyZWFzID0gW107XG4gICAgZm9yIChsZXQgciA9IDA7IHIgPCByb3dzOyByICs9IDEpIHtcbiAgICAgIGNvbnN0IGFyZWFzUm93ID0gW107XG4gICAgICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbHM7IGMgKz0gMSkge1xuICAgICAgICBhcmVhc1Jvdy5wdXNoKHVuZGVmaW5lZCk7XG4gICAgICB9XG4gICAgICB0aGlzLmFyZWFzLnB1c2goYXJlYXNSb3cpO1xuICAgIH1cbiAgICBmb3IgKGxldCByID0gMDsgciA8IHJvd3M7IHIgKz0gMSkge1xuICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb2xzOyBjICs9IDEpIHtcbiAgICAgICAgY29uc3QgY3VyQ29sb3IgPSBjb2RlW3JdW2NdO1xuICAgICAgICBpZiAodGhpcy5hcmVhc1tyXVtjXSA9PT0gdW5kZWZpbmVkICYmIGN1ckNvbG9yICE9PSAxOSkge1xuICAgICAgICAgIGNvbnN0IG5ld0FyZWEgPSB7XG4gICAgICAgICAgICBjZWxsczogW10sXG4gICAgICAgICAgICBjb2xvcjogY3VyQ29sb3IsXG4gICAgICAgICAgICBmcm9udGllcjogWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgICAgICAgICAgZnJvbnRpZXJPdXQ6IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICAgICAgICAgIGZyb250aWVyQmxvY2tlZDogQXJyYXkoOCkuZmlsbChmYWxzZSksXG4gICAgICAgICAgfTtcbiAgICAgICAgICBjb25zdCBzdGFjayA9IFtbciwgY11dO1xuICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IFtjdXJSLCBjdXJDXSA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuYXJlYXNbY3VyUl1bY3VyQ10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICB0aGlzLmFyZWFzW2N1clJdW2N1ckNdID0gbmV3QXJlYTtcbiAgICAgICAgICAgICAgbmV3QXJlYS5jZWxscy5wdXNoKFtjdXJSLCBjdXJDXSk7XG4gICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICBbY3VyUiAtIDEsIGN1ckNdLFxuICAgICAgICAgICAgICAgIFtjdXJSLCBjdXJDIC0gMV0sXG4gICAgICAgICAgICAgICAgW2N1clIgKyAxLCBjdXJDXSxcbiAgICAgICAgICAgICAgICBbY3VyUiwgY3VyQyArIDFdLFxuICAgICAgICAgICAgICBdLmZvckVhY2goKFtuZXh0UiwgbmV4dENdKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgbmV4dFIgPj0gMCAmJlxuICAgICAgICAgICAgICAgICAgbmV4dFIgPCByb3dzICYmXG4gICAgICAgICAgICAgICAgICBuZXh0QyA+PSAwICYmXG4gICAgICAgICAgICAgICAgICBuZXh0QyA8IGNvbHMgJiZcbiAgICAgICAgICAgICAgICAgIGNvZGVbbmV4dFJdW25leHRDXSA9PT0gY3VyQ29sb3IgJiZcbiAgICAgICAgICAgICAgICAgIGN1ckNvbG9yICE9PSAxOFxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgc3RhY2sucHVzaChbbmV4dFIsIG5leHRDXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gZnJvbnRpZXIgY2FsY3VsYXRpb24gKHJpZ2h0IHgyLCBkb3duIHgyLCBsZWZ0IHgyLCB1cCB4MilcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkgKz0gMSkge1xuICAgICAgICAgICAgbmV3QXJlYS5mcm9udGllcltpXSA9IFtyLCBjXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbmV3QXJlYS5jZWxscy5mb3JFYWNoKChbY3VyUiwgY3VyQ10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmRzID0gW1xuICAgICAgICAgICAgICAoW2ZyLCBmY10pID0+IGN1ckMgPiBmYyB8fCAoY3VyQyA9PT0gZmMgJiYgY3VyUiA8IGZyKSxcbiAgICAgICAgICAgICAgKFtmciwgZmNdKSA9PiBjdXJDID4gZmMgfHwgKGN1ckMgPT09IGZjICYmIGN1clIgPiBmciksXG4gICAgICAgICAgICAgIChbZnIsIGZjXSkgPT4gY3VyUiA+IGZyIHx8IChjdXJSID09PSBmciAmJiBjdXJDID4gZmMpLFxuICAgICAgICAgICAgICAoW2ZyLCBmY10pID0+IGN1clIgPiBmciB8fCAoY3VyUiA9PT0gZnIgJiYgY3VyQyA8IGZjKSxcbiAgICAgICAgICAgICAgKFtmciwgZmNdKSA9PiBjdXJDIDwgZmMgfHwgKGN1ckMgPT09IGZjICYmIGN1clIgPiBmciksXG4gICAgICAgICAgICAgIChbZnIsIGZjXSkgPT4gY3VyQyA8IGZjIHx8IChjdXJDID09PSBmYyAmJiBjdXJSIDwgZnIpLFxuICAgICAgICAgICAgICAoW2ZyLCBmY10pID0+IGN1clIgPCBmciB8fCAoY3VyUiA9PT0gZnIgJiYgY3VyQyA8IGZjKSxcbiAgICAgICAgICAgICAgKFtmciwgZmNdKSA9PiBjdXJSIDwgZnIgfHwgKGN1clIgPT09IGZyICYmIGN1ckMgPiBmYyksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgY29uZHMuZm9yRWFjaCgoY29uZCwgaSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBmcm9udCA9IG5ld0FyZWEuZnJvbnRpZXJbaV07XG4gICAgICAgICAgICAgIGlmIChjb25kKGZyb250KSkge1xuICAgICAgICAgICAgICAgIG5ld0FyZWEuZnJvbnRpZXJbaV0gPSBbY3VyUiwgY3VyQ107XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBbZnIsIGZjXSA9IG5ld0FyZWEuZnJvbnRpZXJbaV07XG4gICAgICAgICAgICBjb25zdCBvdXRSID0gZnIgKyBQaWV0UnVuLnJPZmZbKGkgLyAyKSB8IDBdO1xuICAgICAgICAgICAgY29uc3Qgb3V0QyA9IGZjICsgUGlldFJ1bi5jT2ZmWyhpIC8gMikgfCAwXTtcbiAgICAgICAgICAgIG5ld0FyZWEuZnJvbnRpZXJPdXRbaV0gPSBbb3V0Uiwgb3V0Q107XG4gICAgICAgICAgICBuZXdBcmVhLmZyb250aWVyQmxvY2tlZFtpXSA9XG4gICAgICAgICAgICAgIG91dFIgPCAwIHx8XG4gICAgICAgICAgICAgIG91dFIgPj0gcm93cyB8fFxuICAgICAgICAgICAgICBvdXRDIDwgMCB8fFxuICAgICAgICAgICAgICBvdXRDID49IGNvbHMgfHxcbiAgICAgICAgICAgICAgY29kZVtvdXRSXVtvdXRDXSA9PT0gMTk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHN0YXJ0QXJlYSA9IHRoaXMuYXJlYXNbMF1bMF07XG4gICAgW3RoaXMuY3VyUiwgdGhpcy5jdXJDXSA9IHN0YXJ0QXJlYS5mcm9udGllclt0aGlzLmRwICogMiArIHRoaXMuY2NdO1xuICB9XG5cbiAgc3RlcCgpIHtcbiAgICBjb25zdCBjeWNsZURldGVjdGVkID0gdGhpcy50cnlIaXN0b3J5LnNvbWUoXG4gICAgICAoW3IsIGMsIGRwLCBjY10pID0+XG4gICAgICAgIHRoaXMuY3VyUiA9PT0gciAmJiB0aGlzLmN1ckMgPT09IGMgJiYgdGhpcy5kcCA9PT0gZHAgJiYgdGhpcy5jYyA9PT0gY2MsXG4gICAgKTtcbiAgICBpZiAoY3ljbGVEZXRlY3RlZCkge1xuICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGN1ckFyZWEgPSB0aGlzLmFyZWFzW3RoaXMuY3VyUl1bdGhpcy5jdXJDXTtcbiAgICBjb25zdCB7IGNvbG9yLCBmcm9udGllck91dCwgZnJvbnRpZXJCbG9ja2VkIH0gPSBjdXJBcmVhO1xuICAgIGNvbnN0IFtuZXh0UiwgbmV4dENdID0gZnJvbnRpZXJPdXRbdGhpcy5kcCAqIDIgKyB0aGlzLmNjXTtcbiAgICBjb25zdCBibG9ja2VkID0gZnJvbnRpZXJCbG9ja2VkW3RoaXMuZHAgKiAyICsgdGhpcy5jY107XG4gICAgaWYgKGJsb2NrZWQpIHtcbiAgICAgIHRoaXMudHJ5SGlzdG9yeS5wdXNoKFt0aGlzLmN1clIsIHRoaXMuY3VyQywgdGhpcy5kcCwgdGhpcy5jY10pO1xuICAgICAgaWYgKHRoaXMubGFzdENoYW5nZSA9PT0gJ2NjJykge1xuICAgICAgICB0aGlzLmRwID0gKHRoaXMuZHAgKyAxKSAmIDM7XG4gICAgICAgIHRoaXMubGFzdENoYW5nZSA9ICdkcCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNjID0gMSAtIHRoaXMuY2M7XG4gICAgICAgIHRoaXMubGFzdENoYW5nZSA9ICdjYyc7XG4gICAgICB9XG4gICAgICBbdGhpcy5jdXJSLCB0aGlzLmN1ckNdID0gY3VyQXJlYS5mcm9udGllclt0aGlzLmRwICogMiArIHRoaXMuY2NdO1xuICAgICAgdGhpcy5sYXN0Q21kID0gJ2Jsb2NrZWQnO1xuICAgICAgLy8gY29uc29sZS5sb2coJ2Jsb2NrZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sYXN0Q2hhbmdlID0gJ25vbmUnO1xuICAgICAgaWYgKGNvbG9yID09PSAxOCkge1xuICAgICAgICB0aGlzLnRyeUhpc3RvcnkucHVzaChbdGhpcy5jdXJSLCB0aGlzLmN1ckMsIHRoaXMuZHAsIHRoaXMuY2NdKTtcbiAgICAgICAgY29uc3QgbmV4dEFyZWEgPSB0aGlzLmFyZWFzW25leHRSXVtuZXh0Q107XG4gICAgICAgIFt0aGlzLmN1clIsIHRoaXMuY3VyQ10gPSBuZXh0QXJlYS5mcm9udGllclt0aGlzLmRwICogMiArIHRoaXMuY2NdO1xuICAgICAgICB0aGlzLmxhc3RDbWQgPSAnbm9vcCc7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdub29wJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnRyeUhpc3RvcnkubGVuZ3RoID0gMDtcbiAgICAgICAgY29uc3QgbmV4dEFyZWEgPSB0aGlzLmFyZWFzW25leHRSXVtuZXh0Q107XG4gICAgICAgIFt0aGlzLmN1clIsIHRoaXMuY3VyQ10gPSBuZXh0QXJlYS5mcm9udGllclt0aGlzLmRwICogMiArIHRoaXMuY2NdO1xuICAgICAgICBjb25zdCBuZXh0Q29sb3IgPSBuZXh0QXJlYS5jb2xvcjtcbiAgICAgICAgaWYgKG5leHRDb2xvciA9PT0gMTgpIHtcbiAgICAgICAgICB0aGlzLmxhc3RDbWQgPSAnbm9vcCc7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ25vb3AnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBsaWdodERpZmYgPSAoKChuZXh0Q29sb3IgLyA2ICsgMykgfCAwKSAtICgoY29sb3IgLyA2KSB8IDApKSAlIDM7XG4gICAgICAgICAgY29uc3QgaHVlRGlmZiA9ICgobmV4dENvbG9yICUgNikgKyA2IC0gKGNvbG9yICUgNikpICUgNjtcbiAgICAgICAgICB0aGlzLmxhc3RDbWQgPSBQaWV0LmNvbW1hbmRUZXh0W2xpZ2h0RGlmZl1baHVlRGlmZl07XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ2NtZDonLCBsaWdodERpZmYsIGh1ZURpZmYsIHRoaXMubGFzdENtZCk7XG4gICAgICAgICAgUGlldFJ1bi5jbWRzW3RoaXMubGFzdENtZF0odGhpcywgY3VyQXJlYS5jZWxscy5sZW5ndGgpO1xuICAgICAgICAgIFt0aGlzLmN1clIsIHRoaXMuY3VyQ10gPSBuZXh0QXJlYS5mcm9udGllclt0aGlzLmRwICogMiArIHRoaXMuY2NdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgU25hcCBmcm9tICdzbmFwc3ZnJztcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgUGlldCBmcm9tICcuL3BpZXQuanMnO1xuaW1wb3J0IFBpZXRSdW4gZnJvbSAnLi9waWV0LXJ1bi5qcyc7XG5cbmZ1bmN0aW9uIGFkanVzdEhlaWdodCgpIHtcbiAgdGhpcy5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gIHRoaXMuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy5zY3JvbGxIZWlnaHR9cHhgO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQaWV0VUkge1xuICBjb25zdHJ1Y3Rvcihjb2RlKSB7XG4gICAgJCgndGV4dGFyZWEnKVxuICAgICAgLmVhY2goZnVuY3Rpb24gc2V0QXR0cigpIHtcbiAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgJ3N0eWxlJyxcbiAgICAgICAgICBgaGVpZ2h0OiR7dGhpcy5zY3JvbGxIZWlnaHR9cHg7b3ZlcmZsb3cteTpoaWRkZW47YCxcbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgICAub24oJ2lucHV0JywgYWRqdXN0SGVpZ2h0KTtcblxuICAgIHRoaXMucGFsZXR0ZVN2ZyA9IFNuYXAoJyNzdmctcGFsZXR0ZScpO1xuICAgIHRoaXMucGFsZXR0ZVJlY3RzID0gW107XG4gICAgdGhpcy5wYWxldHRlT3ZlcmxheXMgPSBbXTtcbiAgICBmb3IgKGxldCBsaWdodCA9IDA7IGxpZ2h0IDwgMzsgbGlnaHQgKz0gMSkge1xuICAgICAgdGhpcy5wYWxldHRlT3ZlcmxheXMucHVzaChbXSk7XG4gICAgICBmb3IgKGxldCBodWUgPSAwOyBodWUgPCA2OyBodWUgKz0gMSkge1xuICAgICAgICBjb25zdCBjb2xvciA9IGxpZ2h0ICogNiArIGh1ZTtcbiAgICAgICAgY29uc3QgY3VyUmVjdCA9IHRoaXMucGFsZXR0ZVN2Zy5lbCgncmVjdCcsIHtcbiAgICAgICAgICB3aWR0aDogNjAsXG4gICAgICAgICAgaGVpZ2h0OiAzMCxcbiAgICAgICAgICB4OiA2MCAqIGh1ZSxcbiAgICAgICAgICB5OiAzMCAqIGxpZ2h0LFxuICAgICAgICAgIGZpbGw6IFBpZXQuY29sb3JzW2NvbG9yXS5jb2xvcmNvZGUsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBhbGV0dGVSZWN0cy5wdXNoKGN1clJlY3QpO1xuICAgICAgICBjb25zdCBjdXJDbWQgPSB0aGlzLnBhbGV0dGVTdmdcbiAgICAgICAgICAudGV4dCg2MCAqIGh1ZSArIDMwLCAzMCAqIGxpZ2h0ICsgMTUsICcnKVxuICAgICAgICAgIC5hdHRyKHtcbiAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6ICdtaWRkbGUnLFxuICAgICAgICAgICAgJ2RvbWluYW50LWJhc2VsaW5lJzogJ21pZGRsZScsXG4gICAgICAgICAgICAncG9pbnRlci1ldmVudHMnOiAnbm9uZScsXG4gICAgICAgICAgfSk7XG4gICAgICAgIGlmIChodWUgPT09IDQgJiYgbGlnaHQgPj0gMSkge1xuICAgICAgICAgIGN1ckNtZC5hdHRyKHsgZmlsbDogJ3doaXRlJyB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdXJDbWQuYXR0cih7IGZpbGw6ICdibGFjaycgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYWxldHRlT3ZlcmxheXNbbGlnaHRdLnB1c2goY3VyQ21kKTtcbiAgICAgICAgdGhpcy5wYWxldHRlU3ZnLmcoY3VyUmVjdCwgY3VyQ21kKS5jbGljayhlID0+IHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhjb2xvcik7XG4gICAgICAgICAgdGhpcy5lZGl0LnVwZGF0ZUNvbG9yKGNvbG9yKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAobGV0IGNvbG9yID0gMTg7IGNvbG9yIDw9IDE5OyBjb2xvciArPSAxKSB7XG4gICAgICBjb25zdCBjdXJSZWN0ID0gdGhpcy5wYWxldHRlU3ZnXG4gICAgICAgIC5lbCgncmVjdCcsIHtcbiAgICAgICAgICB3aWR0aDogMTgwLFxuICAgICAgICAgIGhlaWdodDogMzAsXG4gICAgICAgICAgeDogMTgwICogKGNvbG9yIC0gMTgpLFxuICAgICAgICAgIHk6IDkwLFxuICAgICAgICAgIGZpbGw6IFBpZXQuY29sb3JzW2NvbG9yXS5jb2xvcmNvZGUsXG4gICAgICAgIH0pXG4gICAgICAgIC5jbGljayhlID0+IHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhjb2xvcik7XG4gICAgICAgICAgdGhpcy5lZGl0LnVwZGF0ZUNvbG9yKGNvbG9yKTtcbiAgICAgICAgfSk7XG4gICAgICB0aGlzLnBhbGV0dGVSZWN0cy5wdXNoKGN1clJlY3QpO1xuICAgIH1cbiAgICB0aGlzLmNvZGVTdmcgPSBTbmFwKCcjc3ZnLWNvZGUnKTtcbiAgICB0aGlzLmNvZGUgPSBuZXcgUGlldChjb2RlKTtcbiAgICBjb25zdCBjb2RlUmVjdCA9IHRoaXMuY29kZVN2Z1xuICAgICAgLmVsKCdyZWN0JywgeyB3aWR0aDogMzAsIGhlaWdodDogMzAgfSlcbiAgICAgIC50b0RlZnMoKTtcbiAgICB0aGlzLmNvZGVSZWN0cyA9IFtbXV07XG4gICAgdGhpcy5jb2RlUmVjdHMudXBkYXRlID0gKCkgPT4ge1xuICAgICAgbGV0IHByZXZSb3dzID0gdGhpcy5jb2RlUmVjdHMubGVuZ3RoO1xuICAgICAgbGV0IHByZXZDb2xzID0gdGhpcy5jb2RlUmVjdHNbMF0ubGVuZ3RoO1xuICAgICAgd2hpbGUgKHByZXZDb2xzIDwgdGhpcy5jb2RlLmNvbHMpIHtcbiAgICAgICAgY29uc3QgYyA9IHByZXZDb2xzO1xuICAgICAgICB0aGlzLmNvZGVSZWN0cy5mb3JFYWNoKChyb3csIHIpID0+IHtcbiAgICAgICAgICBjb25zdCBuZXdSZWN0ID0gdGhpcy5jb2RlU3ZnLnVzZShjb2RlUmVjdCk7XG4gICAgICAgICAgbmV3UmVjdC5hdHRyKHtcbiAgICAgICAgICAgIHg6IDMwICogYyxcbiAgICAgICAgICAgIHk6IDMwICogcixcbiAgICAgICAgICAgIGZpbGw6IFBpZXQuY29sb3JzW3RoaXMuY29kZS5jb2RlW3JdW2NdXS5jb2xvcmNvZGUsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcm93LnB1c2gobmV3UmVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgICBwcmV2Q29scyArPSAxO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHByZXZDb2xzID4gdGhpcy5jb2RlLmNvbHMpIHtcbiAgICAgICAgdGhpcy5jb2RlUmVjdHMuZm9yRWFjaChyb3cgPT4gcm93LnBvcCgpLnJlbW92ZSgpKTtcbiAgICAgICAgcHJldkNvbHMgLT0gMTtcbiAgICAgIH1cbiAgICAgIHdoaWxlIChwcmV2Um93cyA8IHRoaXMuY29kZS5yb3dzKSB7XG4gICAgICAgIGNvbnN0IHIgPSBwcmV2Um93cztcbiAgICAgICAgY29uc3QgbmV3Um93ID0gdGhpcy5jb2RlLmNvZGVbcl0ubWFwKChjb2xvciwgYykgPT4ge1xuICAgICAgICAgIGNvbnN0IGN1clJlY3QgPSB0aGlzLmNvZGVTdmcudXNlKGNvZGVSZWN0KTtcbiAgICAgICAgICByZXR1cm4gY3VyUmVjdC5hdHRyKHtcbiAgICAgICAgICAgIHg6IDMwICogYyxcbiAgICAgICAgICAgIHk6IDMwICogcixcbiAgICAgICAgICAgIGZpbGw6IFBpZXQuY29sb3JzW2NvbG9yXS5jb2xvcmNvZGUsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvZGVSZWN0cy5wdXNoKG5ld1Jvdyk7XG4gICAgICAgIHByZXZSb3dzICs9IDE7XG4gICAgICB9XG4gICAgICB3aGlsZSAocHJldlJvd3MgPiB0aGlzLmNvZGUucm93cykge1xuICAgICAgICB0aGlzLmNvZGVSZWN0cy5wb3AoKS5mb3JFYWNoKHJlY3QgPT4gcmVjdC5yZW1vdmUoKSk7XG4gICAgICAgIHByZXZSb3dzIC09IDE7XG4gICAgICB9XG4gICAgICB0aGlzLmNvZGVSZWN0cy5mb3JFYWNoKChyb3csIHIpID0+IHtcbiAgICAgICAgcm93LmZvckVhY2goKHJlY3QsIGMpID0+IHtcbiAgICAgICAgICByZWN0LmF0dHIoeyBmaWxsOiBQaWV0LmNvbG9yc1t0aGlzLmNvZGUuY29kZVtyXVtjXV0uY29sb3Jjb2RlIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jb2RlU3ZnLmF0dHIoe1xuICAgICAgICB3aWR0aDogMzAgKiB0aGlzLmNvZGUuY29scyArIDgsXG4gICAgICAgIGhlaWdodDogMzAgKiB0aGlzLmNvZGUucm93cyArIDgsXG4gICAgICB9KTtcbiAgICB9O1xuICAgIHRoaXMuY29kZVJlY3RzLnVwZGF0ZSgpO1xuICAgIHRoaXMuZWRpdCA9IHtcbiAgICAgIG1vZGU6ICd3cml0ZScsXG4gICAgICBjb2xvcjogMCxcbiAgICAgIHNlbGVjdENvbG9yOiBjbHIgPT4ge1xuICAgICAgICB0aGlzLnBhbGV0dGVSZWN0c1tjbHJdLmF0dHIoe1xuICAgICAgICAgIHN0cm9rZTogJ2dyYXknLFxuICAgICAgICAgICdzdHJva2Utd2lkdGgnOiA2LFxuICAgICAgICAgIHg6ICcrPTMnLFxuICAgICAgICAgIHk6ICcrPTMnLFxuICAgICAgICAgIHdpZHRoOiAnLT02JyxcbiAgICAgICAgICBoZWlnaHQ6ICctPTYnLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGNsciA8IDE4KSB7XG4gICAgICAgICAgY29uc3QgY3VySHVlID0gY2xyICUgNjtcbiAgICAgICAgICBjb25zdCBjdXJMaWdodCA9IChjbHIgLyA2KSB8IDA7XG4gICAgICAgICAgZm9yIChsZXQgbGlnaHRPZmYgPSAwOyBsaWdodE9mZiA8IDM7IGxpZ2h0T2ZmICs9IDEpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGh1ZU9mZiA9IDA7IGh1ZU9mZiA8IDY7IGh1ZU9mZiArPSAxKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHMgPSBQaWV0LmNvbW1hbmRUZXh0W2xpZ2h0T2ZmXVtodWVPZmZdO1xuICAgICAgICAgICAgICBjb25zdCBuZXh0SHVlID0gKGN1ckh1ZSArIGh1ZU9mZikgJSA2O1xuICAgICAgICAgICAgICBjb25zdCBuZXh0TGlnaHQgPSAoY3VyTGlnaHQgKyBsaWdodE9mZikgJSAzO1xuICAgICAgICAgICAgICB0aGlzLnBhbGV0dGVPdmVybGF5c1tuZXh0TGlnaHRdW25leHRIdWVdLm5vZGUudGV4dENvbnRlbnQgPSBzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGxldCBsaWdodCA9IDA7IGxpZ2h0IDwgMzsgbGlnaHQgKz0gMSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaHVlID0gMDsgaHVlIDwgNjsgaHVlICs9IDEpIHtcbiAgICAgICAgICAgICAgdGhpcy5wYWxldHRlT3ZlcmxheXNbbGlnaHRdW2h1ZV0ubm9kZS50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVuc2VsZWN0Q29sb3I6IGNsciA9PiB7XG4gICAgICAgIHRoaXMucGFsZXR0ZVJlY3RzW2Nscl0uYXR0cih7XG4gICAgICAgICAgc3Ryb2tlOiB1bmRlZmluZWQsXG4gICAgICAgICAgJ3N0cm9rZS13aWR0aCc6IHVuZGVmaW5lZCxcbiAgICAgICAgICB4OiAnLT0zJyxcbiAgICAgICAgICB5OiAnLT0zJyxcbiAgICAgICAgICB3aWR0aDogJys9NicsXG4gICAgICAgICAgaGVpZ2h0OiAnKz02JyxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgdXBkYXRlQ29sb3I6IGNsciA9PiB7XG4gICAgICAgIGNvbnN0IHByZXZDb2xvciA9IHRoaXMuZWRpdC5jb2xvcjtcbiAgICAgICAgdGhpcy5lZGl0LmNvbG9yID0gY2xyO1xuICAgICAgICB0aGlzLmVkaXQudW5zZWxlY3RDb2xvcihwcmV2Q29sb3IpO1xuICAgICAgICB0aGlzLmVkaXQuc2VsZWN0Q29sb3IoY2xyKTtcbiAgICAgIH0sXG4gICAgICB1cGRhdGVDb2RlQ29sb3IxOiAociwgYywgY2xyKSA9PiB7XG4gICAgICAgIHRoaXMuY29kZS5jb2RlW3JdW2NdID0gY2xyO1xuICAgICAgICB0aGlzLmNvZGVSZWN0c1tyXVtjXS5hdHRyKHsgZmlsbDogUGlldC5jb2xvcnNbY2xyXS5jb2xvcmNvZGUgfSk7XG4gICAgICB9LFxuICAgIH07XG4gICAgdGhpcy5lZGl0LnNlbGVjdENvbG9yKDApO1xuXG4gICAgWydsJywgJ3UnLCAncicsICdkJ10uZm9yRWFjaChkaXJlY3Rpb24gPT4ge1xuICAgICAgWydwbHVzJywgJ21pbnVzJ10uZm9yRWFjaChhY3Rpb24gPT4ge1xuICAgICAgICBjb25zdCBpZCA9IGAjZ3JpZC0ke2RpcmVjdGlvbn0ke2FjdGlvbn1gO1xuICAgICAgICBjb25zdCBidXR0b24gPSAkKGlkKTtcbiAgICAgICAgYnV0dG9uLm9uKCdjbGljaycsIGUgPT4ge1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdwbHVzJykge1xuICAgICAgICAgICAgdGhpcy5jb2RlLmV4dGVuZENvZGUoZGlyZWN0aW9uKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb2RlLnNocmlua0NvZGUoZGlyZWN0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jb2RlUmVjdHMudXBkYXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCB3cml0ZUJ1dHRvbiA9ICQoJyNncmlkLXdyaXRlJyk7XG4gICAgY29uc3QgcGlja0J1dHRvbiA9ICQoJyNncmlkLXBpY2snKTtcbiAgICB3cml0ZUJ1dHRvbi5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmNvZGVTdmcudW5jbGljaygpO1xuICAgICAgdGhpcy5jb2RlU3ZnLmRyYWcoXG4gICAgICAgIChkeCwgZHksIHgsIHksIGUpID0+IHtcbiAgICAgICAgICBjb25zdCBjdXJSID0gKChlLm9mZnNldFkgLSAzKSAvIDMwKSB8IDA7XG4gICAgICAgICAgY29uc3QgY3VyQyA9ICgoZS5vZmZzZXRYIC0gMykgLyAzMCkgfCAwO1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIGN1clIgPj0gMCAmJlxuICAgICAgICAgICAgY3VyUiA8IHRoaXMuY29kZS5yb3dzICYmXG4gICAgICAgICAgICBjdXJDID49IDAgJiZcbiAgICAgICAgICAgIGN1ckMgPCB0aGlzLmNvZGUuY29sc1xuICAgICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5lZGl0LnVwZGF0ZUNvZGVDb2xvcjEoY3VyUiwgY3VyQywgdGhpcy5lZGl0LmNvbG9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICh4LCB5LCBlKSA9PiB7XG4gICAgICAgICAgY29uc3QgY3VyUiA9ICgoZS5vZmZzZXRZIC0gMykgLyAzMCkgfCAwO1xuICAgICAgICAgIGNvbnN0IGN1ckMgPSAoKGUub2Zmc2V0WCAtIDMpIC8gMzApIHwgMDtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBjdXJSID49IDAgJiZcbiAgICAgICAgICAgIGN1clIgPCB0aGlzLmNvZGUucm93cyAmJlxuICAgICAgICAgICAgY3VyQyA+PSAwICYmXG4gICAgICAgICAgICBjdXJDIDwgdGhpcy5jb2RlLmNvbHNcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdC51cGRhdGVDb2RlQ29sb3IxKGN1clIsIGN1ckMsIHRoaXMuZWRpdC5jb2xvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAoKSA9PiB7fSxcbiAgICAgICk7XG4gICAgfSk7XG4gICAgcGlja0J1dHRvbi5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmNvZGVTdmcudW5kcmFnKCk7XG4gICAgICB0aGlzLmNvZGVTdmcuY2xpY2soZSA9PiB7XG4gICAgICAgIGNvbnN0IGN1clIgPSAoKGUub2Zmc2V0WSAtIDMpIC8gMzApIHwgMDtcbiAgICAgICAgY29uc3QgY3VyQyA9ICgoZS5vZmZzZXRYIC0gMykgLyAzMCkgfCAwO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgY3VyUiA+PSAwICYmXG4gICAgICAgICAgY3VyUiA8IHRoaXMuY29kZS5yb3dzICYmXG4gICAgICAgICAgY3VyQyA+PSAwICYmXG4gICAgICAgICAgY3VyQyA8IHRoaXMuY29kZS5jb2xzXG4gICAgICAgICkge1xuICAgICAgICAgIHRoaXMuZWRpdC51cGRhdGVDb2xvcih0aGlzLmNvZGUuY29kZVtjdXJSXVtjdXJDXSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHdyaXRlQnV0dG9uLnRyaWdnZXIoJ2NsaWNrJyk7XG5cbiAgICB0aGlzLmV4cG9ydCA9IHtcbiAgICAgIHBuZ0J1dHRvbjogJCgnI2V4cG9ydC1wbmcnKSxcbiAgICAgIHN2Z0J1dHRvbjogJCgnI2V4cG9ydC1zdmcnKSxcbiAgICAgIGFzY2lpR3JpZDogJCgnI2V4cG9ydC1hc2NpaS1ncmlkJyksXG4gICAgICBhc2NpaU1pbmk6ICQoJyNleHBvcnQtYXNjaWktbWluaScpLFxuICAgICAgc2hhcmVDb250ZW50OiAkKCcjc2hhcmUtY29udGVudCcpLFxuICAgICAgdXBkYXRlRXhwb3J0TGluazogKCkgPT4ge1xuICAgICAgICBjb25zdCB7IHJvd3MsIGNvbHMgfSA9IHRoaXMuY29kZTtcbiAgICAgICAgY29uc3QgbWF0cml4ID0gdGhpcy5jb2RlLmNvZGU7XG4gICAgICAgIGNvbnN0IGNhbnZhcyA9ICQoJzxjYW52YXMvPicpO1xuICAgICAgICBjYW52YXMucHJvcCh7IHdpZHRoOiBjb2xzLCBoZWlnaHQ6IHJvd3MgfSk7XG4gICAgICAgIGNvbnN0IGNhbnZhc0VsID0gY2FudmFzLmdldCgwKTtcbiAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzRWwuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgY29uc3QgaW1kYXRhID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCBjb2xzLCByb3dzKTtcbiAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCByb3dzOyByICs9IDEpIHtcbiAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbHM7IGMgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgaWR4ID0gKHIgKiBjb2xzICsgYykgKiA0O1xuICAgICAgICAgICAgY29uc3QgeyBjb2xvcnZlYyB9ID0gUGlldC5jb2xvcnNbbWF0cml4W3JdW2NdXTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgIGltZGF0YS5kYXRhW2lkeCArIGldID0gY29sb3J2ZWNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGN0eC5wdXRJbWFnZURhdGEoaW1kYXRhLCAwLCAwKTtcbiAgICAgICAgY2FudmFzRWwudG9CbG9iKGJsb2IgPT4ge1xuICAgICAgICAgIGNvbnN0IHBuZ1VybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICAgICAgdGhpcy5leHBvcnQucG5nQnV0dG9uLnByb3AoeyBocmVmOiBwbmdVcmwgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjb25zdCBwbmdVcmwgPSBjYW52YXNFbC50b0RhdGFVUkwoJ2ltYWdlL3BuZycpO1xuICAgICAgICAvLyB0aGlzLmV4cG9ydC5wbmdCdXR0b24ucHJvcCh7IGhyZWY6IHBuZ1VybCB9KTtcbiAgICAgICAgY29uc3Qgc3ZnU3RyID0gdGhpcy5jb2RlU3ZnXG4gICAgICAgICAgLm91dGVyU1ZHKClcbiAgICAgICAgICAucmVwbGFjZSgnPHN2ZycsICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIicpO1xuICAgICAgICBjb25zdCBzdmdCbG9iID0gbmV3IEJsb2IoW3N2Z1N0cl0pO1xuICAgICAgICBjb25zdCBzdmdVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN2Z0Jsb2IpO1xuICAgICAgICB0aGlzLmV4cG9ydC5zdmdCdXR0b24ucHJvcCh7IGhyZWY6IHN2Z1VybCB9KTtcbiAgICAgIH0sXG4gICAgfTtcbiAgICAkKCcjbmF2LXNoYXJlLXRhYicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuZXhwb3J0LnVwZGF0ZUV4cG9ydExpbmsoKTtcbiAgICB9KTtcbiAgICB0aGlzLmV4cG9ydC5hc2NpaUdyaWQub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXAgPSB0aGlzLmNvZGUudG9Bc2NpaVBpZXQoZmFsc2UpO1xuICAgICAgdGhpcy5leHBvcnQuc2hhcmVDb250ZW50LnZhbChhcCk7XG4gICAgICBhZGp1c3RIZWlnaHQuY2FsbCh0aGlzLmV4cG9ydC5zaGFyZUNvbnRlbnQuZ2V0KDApKTtcbiAgICB9KTtcbiAgICB0aGlzLmV4cG9ydC5hc2NpaU1pbmkub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXAgPSB0aGlzLmNvZGUudG9Bc2NpaVBpZXQodHJ1ZSk7XG4gICAgICB0aGlzLmV4cG9ydC5zaGFyZUNvbnRlbnQudmFsKGFwKTtcbiAgICAgIGFkanVzdEhlaWdodC5jYWxsKHRoaXMuZXhwb3J0LnNoYXJlQ29udGVudC5nZXQoMCkpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5pbXBvcnQgPSB7XG4gICAgICBmaWxlQnV0dG9uOiAkKCcjaW1wb3J0LWZpbGUnKSxcbiAgICAgIGZpbGVJbnB1dEJ1dHRvbjogJCgnI2ltcG9ydC1maWxlLWlucHV0JyksXG4gICAgICBhc2NpaUJ1dHRvbjogJCgnI2ltcG9ydC1hc2NpaScpLFxuICAgICAgYXNjaWlUZXh0OiAkKCcjc2hhcmUtY29udGVudCcpLFxuICAgIH07XG4gICAgdGhpcy5pbXBvcnQuYXNjaWlCdXR0b24ub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXNjaWkgPSB0aGlzLmltcG9ydC5hc2NpaVRleHQudmFsKCk7XG4gICAgICBjb25zdCBjb2RlR3JpZCA9IFBpZXQuZnJvbUFzY2lpUGlldChhc2NpaSk7XG4gICAgICBjb25zb2xlLmxvZyhjb2RlR3JpZCk7XG4gICAgICB0aGlzLmNvZGUucmVwbGFjZUNvZGUoY29kZUdyaWQpO1xuICAgICAgdGhpcy5jb2RlUmVjdHMudXBkYXRlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5pbXBvcnQuZmlsZUJ1dHRvbi5vbignY2xpY2snLCAoKSA9PlxuICAgICAgdGhpcy5pbXBvcnQuZmlsZUlucHV0QnV0dG9uLnRyaWdnZXIoJ2NsaWNrJyksXG4gICAgKTtcbiAgICB0aGlzLmltcG9ydC5maWxlSW5wdXRCdXR0b24ub24oJ2NoYW5nZScsIGUgPT4ge1xuICAgICAgY29uc3QgZmlsZSA9IGUudGFyZ2V0LmZpbGVzWzBdO1xuICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTtcbiAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xuICAgICAgICBsZXQgd2lkdGggPSBpbWcubmF0dXJhbFdpZHRoO1xuICAgICAgICBsZXQgaGVpZ2h0ID0gaW1nLm5hdHVyYWxIZWlnaHQ7XG4gICAgICAgIGNvbnN0IGNhbnZhcyA9ICQoJzxjYW52YXMvPicpO1xuICAgICAgICBjYW52YXMucHJvcCh7IHdpZHRoLCBoZWlnaHQgfSk7XG4gICAgICAgIGNvbnN0IGNhbnZhc0VsID0gY2FudmFzLmdldCgwKTtcbiAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzRWwuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDApO1xuICAgICAgICBjb25zdCBpbWRhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICBjb25zdCBjb2RlR3JpZCA9IFtdO1xuICAgICAgICBpZiAod2lkdGggPT09IDAgfHwgaGVpZ2h0ID09PSAwKSB7XG4gICAgICAgICAgY29kZUdyaWQucHVzaChbMTldKTsgLy8gZmFsbGJhY2sgdG8gc2luZ2xlIGJsYWNrIGNlbGxcbiAgICAgICAgICB3aWR0aCA9IDE7XG4gICAgICAgICAgaGVpZ2h0ID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGxldCByID0gMDsgciA8IGhlaWdodDsgciArPSAxKSB7XG4gICAgICAgICAgICBjb2RlR3JpZC5wdXNoKFtdKTtcbiAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgd2lkdGg7IGMgKz0gMSkge1xuICAgICAgICAgICAgICBjb25zdCBpZHggPSByICogd2lkdGggKiA0ICsgYyAqIDQ7XG4gICAgICAgICAgICAgIGNvbnN0IGNvbG9yID1cbiAgICAgICAgICAgICAgICBQaWV0LmNvbG9ydmVjMmNvbG9yW2ltZGF0YS5kYXRhLnNsaWNlKGlkeCwgaWR4ICsgNCldID8/IDE5O1xuICAgICAgICAgICAgICBjb2RlR3JpZFtyXS5wdXNoKGNvbG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29kZUdyaWQyID0gUGlldC5jb21wcmVzcyhjb2RlR3JpZCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHRoaXMuY29kZS5yZXBsYWNlQ29kZShjb2RlR3JpZDIpO1xuICAgICAgICB0aGlzLmNvZGVSZWN0cy51cGRhdGUoKTtcbiAgICAgIH07XG4gICAgICBpbWcuc3JjID0gdXJsO1xuICAgIH0pO1xuXG4gICAgJCgnI25hdi1kZWJ1Zy10YWInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb2RlR3JpZCA9IHRoaXMuY29kZS5jb2RlO1xuICAgICAgY29uc3Qgc3RhcnRFbCA9ICQoJyNkZWJ1Zy1zdGFydCcpO1xuICAgICAgY29uc3Qgc3RlcEVsID0gJCgnI2RlYnVnLXN0ZXAnKTtcbiAgICAgIGNvbnN0IHJlc2V0RWwgPSAkKCcjZGVidWctcmVzZXQnKTtcbiAgICAgIGNvbnN0IGlucHV0RWwgPSAkKCcjZGVidWctaW5wdXQnKTtcbiAgICAgIGNvbnN0IG91dHB1dEVsID0gJCgnI2RlYnVnLW91dHB1dCcpO1xuICAgICAgY29uc3Qgc3RhY2tFbCA9ICQoJyNkZWJ1Zy1zdGFjaycpO1xuICAgICAgY29uc3Qgc3RhdHVzRWwgPSAkKCcjZGVidWctc3RhdHVzJyk7XG4gICAgICBjb25zdCBkcEVsID0gJCgnI2RlYnVnLWRwJyk7XG4gICAgICBjb25zdCBjY0VsID0gJCgnI2RlYnVnLWNjJyk7XG4gICAgICBjb25zdCBjbWRFbCA9ICQoJyNkZWJ1Zy1jbWQnKTtcbiAgICAgIGNvbnN0IHNwZWVkRWwgPSAkKCcjZGVidWctc3BlZWQnKTtcbiAgICAgIGNvbnN0IHJ1bkVsID0gJCgnI2RlYnVnLXJ1bicpO1xuICAgICAgY29uc3QgcGF1c2VFbCA9ICQoJyNkZWJ1Zy1wYXVzZScpO1xuICAgICAgc3RhcnRFbC5vZmYoJ2NsaWNrJyk7XG4gICAgICBzdGVwRWwub2ZmKCdjbGljaycpO1xuICAgICAgcmVzZXRFbC5vZmYoJ2NsaWNrJyk7XG4gICAgICBydW5FbC5vZmYoJ2NsaWNrJyk7XG4gICAgICBwYXVzZUVsLm9mZignY2xpY2snKTtcbiAgICAgIGxldCBhbmltYXRpb25JZDtcbiAgICAgIGxldCBhbmltYXRpb25TdGFydFRpbWU7XG4gICAgICBsZXQgYW5pbWF0aW9uU3BlZWQ7XG4gICAgICBsZXQgYW5pbWF0aW9uU3RlcHM7XG4gICAgICBsZXQgb3JpZ0lucHV0O1xuICAgICAgbGV0IGFycm93RWw7XG4gICAgICBjb25zdCB1cGRhdGVVaSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgeyBkcCwgY2MsIGlucHV0LCBvdXRwdXQsIHN0YWNrLCBsYXN0Q21kIH0gPSB0aGlzLnJ1bm5lcjtcbiAgICAgICAgY29uc3QgZHBEZXNjID0gUGlldFJ1bi5kcFRleHRbZHBdO1xuICAgICAgICBjb25zdCBjY0Rlc2MgPSBQaWV0UnVuLmNjVGV4dFtkcCAqIDIgKyBjY107XG4gICAgICAgIGRwRWwudGV4dChgJHtkcH0gKCR7ZHBEZXNjfSlgKTtcbiAgICAgICAgY2NFbC50ZXh0KGAke2NjfSAoJHtjY0Rlc2N9KWApO1xuICAgICAgICBpbnB1dEVsLnZhbChpbnB1dCk7XG4gICAgICAgIG91dHB1dEVsLnZhbChvdXRwdXQpO1xuICAgICAgICBjb25zdCBzdGFja1N0ciA9IHN0YWNrLm1hcChuID0+IG4udG9TdHJpbmcoKSkuam9pbignICcpO1xuICAgICAgICBzdGFja0VsLnZhbChzdGFja1N0cik7XG4gICAgICAgIGFkanVzdEhlaWdodC5jYWxsKGlucHV0RWwuZ2V0KDApKTtcbiAgICAgICAgYWRqdXN0SGVpZ2h0LmNhbGwob3V0cHV0RWwuZ2V0KDApKTtcbiAgICAgICAgYWRqdXN0SGVpZ2h0LmNhbGwoc3RhY2tFbC5nZXQoMCkpO1xuICAgICAgICBjbWRFbC50ZXh0KGxhc3RDbWQpO1xuICAgICAgfTtcbiAgICAgIHN0YXJ0RWwub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBvdXRwdXRFbC52YWwoJycpO1xuICAgICAgICBhZGp1c3RIZWlnaHQuY2FsbChvdXRwdXRFbC5nZXQoMCkpO1xuICAgICAgICBpZiAoY29kZUdyaWRbMF1bMF0gPT09IDE5KSB7XG4gICAgICAgICAgc3RhdHVzRWwudGV4dCgnRXJyb3I6IFN0YXJ0aW5nIGJsYWNrIGNlbGwgZGV0ZWN0ZWQnKTtcbiAgICAgICAgICBkcEVsLnRleHQoJ04vQScpO1xuICAgICAgICAgIGNjRWwudGV4dCgnTi9BJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb3JpZ0lucHV0ID0gaW5wdXRFbC52YWwoKTtcbiAgICAgICAgICB0aGlzLnJ1bm5lciA9IG5ldyBQaWV0UnVuKGNvZGVHcmlkLCBvcmlnSW5wdXQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMucnVubmVyKTtcbiAgICAgICAgICBzdGFydEVsLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgICAgc3RlcEVsLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgIHJlc2V0RWwucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgICAgcnVuRWwucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgICAgaW5wdXRFbC5wcm9wKCdyZWFkb25seScsIHRydWUpO1xuICAgICAgICAgIHN0YXR1c0VsLnRleHQoJ1J1bm5pbmcnKTtcbiAgICAgICAgICB1cGRhdGVVaSgpO1xuICAgICAgICAgIGFycm93RWwgPSB0aGlzLmNvZGVTdmcucG9seWdvbigyMCwgNSwgMjAsIDI1LCAzMCwgMTUpO1xuICAgICAgICAgIGFycm93RWwuYXR0cih7IGZpbGw6ICdncmF5JyB9KTtcbiAgICAgICAgICBjb25zdCBtYXQgPSBTbmFwLm1hdHJpeCgpLnRyYW5zbGF0ZShcbiAgICAgICAgICAgIHRoaXMucnVubmVyLmN1ckMgKiAzMCxcbiAgICAgICAgICAgIHRoaXMucnVubmVyLmN1clIgKiAzMCxcbiAgICAgICAgICApO1xuICAgICAgICAgIGFycm93RWwudHJhbnNmb3JtKG1hdCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgc3RlcEVsLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3N0ZXAnKTtcbiAgICAgICAgc3RhdHVzRWwudGV4dCgnUnVubmluZycpO1xuICAgICAgICB0aGlzLnJ1bm5lci5zdGVwKCk7XG4gICAgICAgIHVwZGF0ZVVpKCk7XG4gICAgICAgIGNvbnN0IG1hdCA9IFNuYXAubWF0cml4KClcbiAgICAgICAgICAudHJhbnNsYXRlKHRoaXMucnVubmVyLmN1ckMgKiAzMCwgdGhpcy5ydW5uZXIuY3VyUiAqIDMwKVxuICAgICAgICAgIC5yb3RhdGUodGhpcy5ydW5uZXIuZHAgKiA5MCwgMTUsIDE1KTtcbiAgICAgICAgYXJyb3dFbC50cmFuc2Zvcm0obWF0KTtcbiAgICAgICAgaWYgKHRoaXMucnVubmVyLmZpbmlzaGVkKSB7XG4gICAgICAgICAgc3RlcEVsLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgICAgc3RhdHVzRWwudGV4dCgnRmluaXNoZWQnKTtcbiAgICAgICAgICBhcnJvd0VsLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJ1bkVsLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgYW5pbWF0aW9uU3BlZWQgPSBOdW1iZXIoc3BlZWRFbC52YWwoKSk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBOdW1iZXIuaXNTYWZlSW50ZWdlcihhbmltYXRpb25TcGVlZCkgJiZcbiAgICAgICAgICBhbmltYXRpb25TcGVlZCA+IDAgJiZcbiAgICAgICAgICBhbmltYXRpb25TcGVlZCA8PSAxMDBcbiAgICAgICAgKSB7XG4gICAgICAgICAgcnVuRWwucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICBwYXVzZUVsLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgIHN0ZXBFbC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgIHN0YXR1c0VsLnRleHQoJ1J1bm5pbmcnKTtcbiAgICAgICAgICBhbmltYXRpb25TdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgICBhbmltYXRpb25TdGVwcyA9IDA7XG4gICAgICAgICAgY29uc3QgdXBkYXRlRnJhbWUgPSB0aW1lID0+IHtcbiAgICAgICAgICAgIGFuaW1hdGlvbklkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZUZyYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVFbGFwc2VkID0gdGltZSAtIGFuaW1hdGlvblN0YXJ0VGltZTtcbiAgICAgICAgICAgIGNvbnN0IG5leHRTdGVwcyA9IE1hdGguY2VpbCgoYW5pbWF0aW9uU3BlZWQgKiB0aW1lRWxhcHNlZCkgLyAxMDAwKTtcbiAgICAgICAgICAgIGZvciAoOyBhbmltYXRpb25TdGVwcyA8IG5leHRTdGVwczsgYW5pbWF0aW9uU3RlcHMgKz0gMSkge1xuICAgICAgICAgICAgICBzdGVwRWwudHJpZ2dlcignY2xpY2snKTtcbiAgICAgICAgICAgICAgaWYgKHRoaXMucnVubmVyLmZpbmlzaGVkKSB7XG4gICAgICAgICAgICAgICAgcGF1c2VFbC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbklkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIGFuaW1hdGlvbklkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZUZyYW1lKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBzcGVlZCB2YWx1ZScpO1xuICAgICAgICAgIHN0YXR1c0VsLnRleHQoJ0ludmFsaWQgc3BlZWQgdmFsdWUuIEFsbG93ZWQgdmFsdWVzOiAxIC0gMTAwJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcGF1c2VFbC5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHJ1bkVsLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICBwYXVzZUVsLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIHN0ZXBFbC5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoYW5pbWF0aW9uSWQpO1xuICAgICAgfSk7XG4gICAgICByZXNldEVsLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Jlc2V0Jyk7XG4gICAgICAgIHN0YXJ0RWwucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgIHN0ZXBFbC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICByZXNldEVsLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIGlucHV0RWwucHJvcCgncmVhZG9ubHknLCBmYWxzZSk7XG4gICAgICAgIGlucHV0RWwudmFsKG9yaWdJbnB1dCk7XG4gICAgICAgIGFkanVzdEhlaWdodC5jYWxsKGlucHV0RWwuZ2V0KDApKTtcbiAgICAgICAgc3RhdHVzRWwudGV4dCgnTi9BJyk7XG4gICAgICAgIGRwRWwudGV4dCgnTi9BJyk7XG4gICAgICAgIGNjRWwudGV4dCgnTi9BJyk7XG4gICAgICAgIGNtZEVsLnRleHQoJ04vQScpO1xuICAgICAgICBpZiAoYXJyb3dFbCAhPT0gdW5kZWZpbmVkKSBhcnJvd0VsLnJlbW92ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgJCgnI25hdi1lZGl0LXRhYiwgI25hdi10ZXN0LXRhYiwgI25hdi1zaGFyZS10YWInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAkKCcjZGVidWctcmVzZXQnKS50cmlnZ2VyKCdjbGljaycpO1xuICAgIH0pO1xuXG4gICAgJCgnI25hdi10ZXN0LXRhYicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcEVsID0gJCgnI3Rlc3Qtc2VwJyk7XG4gICAgICBjb25zdCBsaW1pdEVsID0gJCgnI3Rlc3QtbGltaXQnKTtcbiAgICAgIGNvbnN0IHJ1bkVsID0gJCgnI3Rlc3QtcnVuJyk7XG4gICAgICBjb25zdCBzdG9wRWwgPSAkKCcjdGVzdC1zdG9wJyk7XG4gICAgICBjb25zdCBlc2NhcGVFbCA9ICQoJyN0ZXN0LWVzY2FwZScpO1xuICAgICAgY29uc3Qgc3RhdHVzRWwgPSAkKCcjdGVzdC1zdGF0dXMnKTtcbiAgICAgIGNvbnN0IGlucHV0RWwgPSAkKCcjdGVzdC1pbnB1dCcpO1xuICAgICAgY29uc3Qgb3V0cHV0RWwgPSAkKCcjdGVzdC1vdXRwdXQnKTtcblxuICAgICAgcnVuRWwub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBzZXAgPSBzZXBFbC52YWwoKSA9PT0gJycgPyAnLS0tJyA6IHNlcEVsLnZhbCgpO1xuICAgICAgICBzZXBFbC52YWwoc2VwKTtcbiAgICAgICAgY29uc3QgbGltaXRWYWwgPSBOdW1iZXIobGltaXRFbC52YWwoKSk7XG4gICAgICAgIGNvbnN0IGxpbWl0ID1cbiAgICAgICAgICBOdW1iZXIuaXNTYWZlSW50ZWdlcihsaW1pdFZhbCkgJiYgbGltaXRWYWwgPiAwID8gbGltaXRWYWwgOiAxMDAwMDtcbiAgICAgICAgbGltaXRFbC52YWwobGltaXQpO1xuICAgICAgICBydW5FbC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICBzdG9wRWwucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgIGlucHV0RWwucHJvcCgncmVhZG9ubHknLCB0cnVlKTtcbiAgICAgICAgY29uc3QgZG9Fc2NhcGUgPSBlc2NhcGVFbC5wcm9wKCdjaGVja2VkJyk7XG4gICAgICAgIGxldCBpbnB1dHMgPSBpbnB1dEVsLnZhbCgpLnNwbGl0KGBcXG4ke3NlcH1cXG5gKTtcbiAgICAgICAgaWYgKGRvRXNjYXBlKSB7XG4gICAgICAgICAgaW5wdXRzID0gaW5wdXRzLm1hcChzID0+XG4gICAgICAgICAgICBzLnJlcGxhY2UoXG4gICAgICAgICAgICAgIC9cXFxcWzAnXCJcXFxcbnJ2dGJmXXxcXFxcdVswLTlhLWZBLUZdezR9fFxcXFx1XFx7WzAtOWEtZkEtRl0rXFx9fFxcXFx4WzAtOWEtZkEtRl17Mn0vZyxcbiAgICAgICAgICAgICAgbWF0Y2ggPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaC5zdGFydHNXaXRoKCdcXFxcdScpIHx8IG1hdGNoLnN0YXJ0c1dpdGgoJ1xcXFx4JykpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGhleCA9IG1hdGNoLnN0YXJ0c1dpdGgoJ1xcXFx1eycpXG4gICAgICAgICAgICAgICAgICAgID8gbWF0Y2guc2xpY2UoMywgLTEpXG4gICAgICAgICAgICAgICAgICAgIDogbWF0Y2guc2xpY2UoMik7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21Db2RlUG9pbnQoTnVtYmVyLnBhcnNlSW50KGhleCwgMTYpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICdcXFxcMCc6ICdcXDAnLFxuICAgICAgICAgICAgICAgICAgXCJcXFxcJ1wiOiBcIidcIixcbiAgICAgICAgICAgICAgICAgICdcXFxcXCInOiAnXCInLFxuICAgICAgICAgICAgICAgICAgJ1xcXFxcXFxcJzogJ1xcXFwnLFxuICAgICAgICAgICAgICAgICAgJ1xcXFxuJzogJ1xcbicsXG4gICAgICAgICAgICAgICAgICAnXFxcXHInOiAnXFxyJyxcbiAgICAgICAgICAgICAgICAgICdcXFxcdic6ICdcXHYnLFxuICAgICAgICAgICAgICAgICAgJ1xcXFx0JzogJ1xcdCcsXG4gICAgICAgICAgICAgICAgICAnXFxcXGInOiAnXFxiJyxcbiAgICAgICAgICAgICAgICAgICdcXFxcZic6ICdcXGYnLFxuICAgICAgICAgICAgICAgIH1bbWF0Y2hdO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJ1bm5lcnMgPSBpbnB1dHMubWFwKGlucHV0ID0+IG5ldyBQaWV0UnVuKHRoaXMuY29kZS5jb2RlLCBpbnB1dCkpO1xuICAgICAgICBjb25zdCBzdGVwc1BlclJ1bm5lciA9IHJ1bm5lcnMubWFwKCgpID0+IDApO1xuICAgICAgICBsZXQgYWxpdmUgPSBydW5uZXJzLmxlbmd0aDtcbiAgICAgICAgY29uc3Qgc3RlcHMgPSAxMDsgLy8gc3RlcHMgcGVyIG1zXG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICBsZXQgc3RlcHNSdW4gPSAwO1xuICAgICAgICBsZXQgcnVuSWQ7XG4gICAgICAgIHN0YXR1c0VsLnRleHQoJ1J1bm5pbmcnKTtcbiAgICAgICAgY29uc3QgdXBkYXRlID0gdGltZSA9PiB7XG4gICAgICAgICAgaWYgKGFsaXZlID09PSAwKSB7XG4gICAgICAgICAgICBzdG9wRWwudHJpZ2dlcignY2xpY2snKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcnVuSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKTtcbiAgICAgICAgICBjb25zdCB0b3RhbFN0ZXBzID0gTWF0aC5jZWlsKHN0ZXBzICogKHRpbWUgLSBzdGFydFRpbWUpKTtcbiAgICAgICAgICBjb25zdCBzaW5nbGVTdGVwcyA9IE1hdGgucm91bmQoKHRvdGFsU3RlcHMgLSBzdGVwc1J1bikgLyBhbGl2ZSk7XG4gICAgICAgICAgcnVubmVycy5mb3JFYWNoKChydW5uZXIsIGkpID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uZXIuZmluaXNoZWQpIHJldHVybjtcbiAgICAgICAgICAgIGZvciAobGV0IHMgPSAwOyBzIDwgc2luZ2xlU3RlcHM7IHMgKz0gMSkge1xuICAgICAgICAgICAgICBydW5uZXIuc3RlcCgpO1xuICAgICAgICAgICAgICBzdGVwc1J1biArPSAxO1xuICAgICAgICAgICAgICBzdGVwc1BlclJ1bm5lcltpXSArPSAxO1xuICAgICAgICAgICAgICBpZiAoc3RlcHNQZXJSdW5uZXJbaV0gPj0gbGltaXQpIHtcbiAgICAgICAgICAgICAgICBydW5uZXIuZmluaXNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChydW5uZXIuZmluaXNoZWQpIHtcbiAgICAgICAgICAgICAgICBhbGl2ZSAtPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHN0b3BFbC5vbmUoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHJ1bklkKTtcbiAgICAgICAgICBjb25zdCBvdXRwdXRzID0gcnVubmVycy5tYXAocnVubmVyID0+IHJ1bm5lci5vdXRwdXQpO1xuICAgICAgICAgIHJ1bm5lcnMuZm9yRWFjaCgocnVubmVyLCBpKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXJ1bm5lci5maW5pc2hlZCkge1xuICAgICAgICAgICAgICBvdXRwdXRzW2ldICs9ICdcXG4qKiBBYm9ydGVkJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcHNQZXJSdW5uZXJbaV0gPj0gbGltaXQpIHtcbiAgICAgICAgICAgICAgb3V0cHV0c1tpXSArPSAnXFxuKiogRXhjZWVkZWQgU3RlcCBMaW1pdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgb3V0cHV0RWwudmFsKG91dHB1dHMuam9pbignXFxuLS0tXFxuJykpO1xuICAgICAgICAgIGFkanVzdEhlaWdodC5jYWxsKG91dHB1dEVsLmdldCgwKSk7XG4gICAgICAgICAgc3RhdHVzRWwudGV4dCgnRmluaXNoZWQnKTtcbiAgICAgICAgICBzdG9wRWwucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICBydW5FbC5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgICBpbnB1dEVsLnByb3AoJ3JlYWRvbmx5JywgZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgcnVuSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQaWV0IHtcbiAgc3RhdGljIGNvbW1hbmRUZXh0ID0gW1xuICAgIFsnJywgJysnLCAnLycsICc+JywgJ2R1cCcsICdpbkMnXSxcbiAgICBbJ3B1c2gnLCAnLScsICclJywgJ0RQKycsICdyb2xsJywgJ291dE4nXSxcbiAgICBbJ3BvcCcsICcqJywgJyEnLCAnQ0MrJywgJ2luTicsICdvdXRDJ10sXG4gIF07XG5cbiAgc3RhdGljIHtcbiAgICB0aGlzLmNoYXIyY29sb3IgPSB7fTtcbiAgICB0aGlzLmNvbG9ydmVjMmNvbG9yID0ge307XG4gICAgdGhpcy5jb2xvcnMgPSBbXTtcbiAgICBjb25zdCBodWVNYXNrID0gWzQsIDYsIDIsIDMsIDEsIDVdO1xuICAgIGNvbnN0IGxpZ2h0U3RyID0gW1xuICAgICAgWydDMCcsICdGRiddLFxuICAgICAgWycwMCcsICdGRiddLFxuICAgICAgWycwMCcsICdDMCddLFxuICAgIF07XG4gICAgZm9yIChsZXQgZGFya25lc3MgPSAwOyBkYXJrbmVzcyA8IDM7IGRhcmtuZXNzICs9IDEpIHtcbiAgICAgIGNvbnN0IGxpZ2h0ID0gbGlnaHRTdHJbZGFya25lc3NdO1xuICAgICAgZm9yIChsZXQgaHVlID0gMDsgaHVlIDwgNjsgaHVlICs9IDEpIHtcbiAgICAgICAgY29uc3QgY2hhcmNvZGUgPSBkYXJrbmVzcyAqIDMyICsgaHVlICsgNDg7XG4gICAgICAgIGxldCBjb2xvcmNvZGUgPSAnIyc7XG4gICAgICAgIGNvbnN0IGNvbG9ydmVjID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgaSArPSAxKSB7XG4gICAgICAgICAgY29uc3QgbmV4dFZhbCA9IGxpZ2h0WyhodWVNYXNrW2h1ZV0gPj4gKDIgLSBpKSkgJiAxXTtcbiAgICAgICAgICBjb2xvcmNvZGUgKz0gbmV4dFZhbDtcbiAgICAgICAgICBjb2xvcnZlYy5wdXNoKE51bWJlci5wYXJzZUludChuZXh0VmFsLCAxNikpO1xuICAgICAgICB9XG4gICAgICAgIGNvbG9ydmVjLnB1c2goMjU1KTtcbiAgICAgICAgY29uc3QgY2hhciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhcmNvZGUpO1xuICAgICAgICB0aGlzLmNvbG9ycy5wdXNoKHsgY2hhcmNvZGUsIGNoYXIsIGNvbG9yY29kZSwgY29sb3J2ZWMgfSk7XG4gICAgICAgIHRoaXMuY2hhcjJjb2xvcltjaGFyXSA9IGRhcmtuZXNzICogNiArIGh1ZTtcbiAgICAgICAgdGhpcy5jb2xvcnZlYzJjb2xvcltjb2xvcnZlY10gPSBkYXJrbmVzcyAqIDYgKyBodWU7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuY29sb3JzLnB1c2goe1xuICAgICAgY2hhcmNvZGU6ICdAJy5jaGFyQ29kZUF0KCksXG4gICAgICBjaGFyOiAnQCcsXG4gICAgICBjb2xvcmNvZGU6ICcjRkZGRkZGJyxcbiAgICAgIGNvbG9ydmVjOiBbMjU1LCAyNTUsIDI1NSwgMjU1XSxcbiAgICB9KTtcbiAgICB0aGlzLmNoYXIyY29sb3JbJ0AnXSA9IDE4O1xuICAgIHRoaXMuY29sb3J2ZWMyY29sb3JbdGhpcy5jb2xvcnNbMThdLmNvbG9ydmVjXSA9IDE4O1xuICAgIHRoaXMuY29sb3JzLnB1c2goe1xuICAgICAgY2hhcmNvZGU6ICcgJy5jaGFyQ29kZUF0KCksXG4gICAgICBjaGFyOiAnICcsXG4gICAgICBjb2xvcmNvZGU6ICcjMDAwMDAwJyxcbiAgICAgIGNvbG9ydmVjOiBbMCwgMCwgMCwgMjU1XSxcbiAgICB9KTtcbiAgICB0aGlzLmNoYXIyY29sb3JbJyAnXSA9IDE5O1xuICAgIHRoaXMuY29sb3J2ZWMyY29sb3JbdGhpcy5jb2xvcnNbMTldLmNvbG9ydmVjXSA9IDE5O1xuICB9XG5cbiAgc3RhdGljIGNvbXByZXNzKGNvZGVHcmlkLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgZnVuY3Rpb24gZ2NkKGEsIGIpIHtcbiAgICAgIGxldCBbeCwgeV0gPSBbYSwgYl07XG4gICAgICB3aGlsZSAoeSAhPT0gMCkge1xuICAgICAgICBbeCwgeV0gPSBbeSwgeCAlIHldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHg7XG4gICAgfVxuICAgIGNvbnN0IGcgPSBnY2Qod2lkdGgsIGhlaWdodCk7XG4gICAgZnVuY3Rpb24gY2hlY2socykge1xuICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCBoZWlnaHQgLyBzOyByICs9IDEpIHtcbiAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCB3aWR0aCAvIHM7IGMgKz0gMSkge1xuICAgICAgICAgIGNvbnN0IHJtaW4gPSByICogcztcbiAgICAgICAgICBjb25zdCBybWF4ID0gKHIgKyAxKSAqIHM7XG4gICAgICAgICAgY29uc3QgY21pbiA9IGMgKiBzO1xuICAgICAgICAgIGNvbnN0IGNtYXggPSAoYyArIDEpICogcztcbiAgICAgICAgICBjb25zdCBleHBlY3RlZCA9IGNvZGVHcmlkW3JtaW5dW2NtaW5dO1xuICAgICAgICAgIGZvciAobGV0IHJyID0gcm1pbjsgcnIgPCBybWF4OyByciArPSAxKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBjYyA9IGNtaW47IGNjIDwgY21heDsgY2MgKz0gMSkge1xuICAgICAgICAgICAgICBpZiAoZXhwZWN0ZWQgIT09IGNvZGVHcmlkW3JyXVtjY10pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBmb3IgKGxldCBnZyA9IGc7IGdnID49IDE7IGdnIC09IDEpIHtcbiAgICAgIGlmIChnICUgZ2cgPT09IDApIHtcbiAgICAgICAgaWYgKGNoZWNrKGdnKSkge1xuICAgICAgICAgIHJldHVybiBjb2RlR3JpZFxuICAgICAgICAgICAgLmZpbHRlcigociwgaSkgPT4gaSAlIGdnID09PSAwKVxuICAgICAgICAgICAgLm1hcChyb3cgPT4gcm93LmZpbHRlcigoYywgaSkgPT4gaSAlIGdnID09PSAwKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvZGVHcmlkO1xuICB9XG5cbiAgc3RhdGljIGZyb21Bc2NpaVBpZXQoYXBjb2RlKSB7XG4gICAgY29uc3QgYXBncmlkID0gYXBjb2RlLnJlcGxhY2UoL1tAQS1aX10vZywgcyA9PiB7XG4gICAgICBpZiAocyA9PT0gJ0AnKSB7XG4gICAgICAgIHJldHVybiAnIFxcbic7XG4gICAgICB9XG4gICAgICBpZiAocyA9PT0gJ18nKSB7XG4gICAgICAgIHJldHVybiAnP1xcbic7XG4gICAgICB9XG4gICAgICByZXR1cm4gYCR7cy50b0xvd2VyQ2FzZSgpfVxcbmA7XG4gICAgfSk7XG4gICAgY29uc3QgYXAgPSAndHZyc3F1bG5qa2ltZGZiY2FlPyAnO1xuICAgIGNvbnN0IGNvZGVHcmlkID0gYXBncmlkXG4gICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAubWFwKHMgPT4gWy4uLnNdLm1hcChjID0+IChhcC5pbmRleE9mKGMpICsgMjApICUgMjApKTtcbiAgICBjb25zdCBjb2xzID0gTWF0aC5tYXgoMSwgLi4uY29kZUdyaWQubWFwKHJvdyA9PiByb3cubGVuZ3RoKSk7XG4gICAgY29kZUdyaWQuZm9yRWFjaChyb3cgPT4ge1xuICAgICAgd2hpbGUgKHJvdy5sZW5ndGggPCBjb2xzKSB7XG4gICAgICAgIHJvdy5wdXNoKDE5KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gY29kZUdyaWQ7XG4gIH1cblxuICB0b0FzY2lpUGlldChjb21wYWN0KSB7XG4gICAgY29uc3QgYXAgPSAndHZyc3F1bG5qa2ltZGZiY2FlPyAnO1xuICAgIGNvbnN0IGNvZGVTdHIgPSB0aGlzLmNvZGUubWFwKHJvdyA9PiB7XG4gICAgICBjb25zdCByb3dTdHIgPSByb3dcbiAgICAgICAgLm1hcChjZWxsID0+IGFwW2NlbGxdKVxuICAgICAgICAuam9pbignJylcbiAgICAgICAgLnRyaW1FbmQoKTtcbiAgICAgIHJldHVybiByb3dTdHI7XG4gICAgfSk7XG4gICAgaWYgKCFjb21wYWN0KSB7XG4gICAgICByZXR1cm4gY29kZVN0ci5qb2luKCdcXG4nKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvZGVTdHJcbiAgICAgIC5tYXAoKHJvdywgaSkgPT4ge1xuICAgICAgICBpZiAoaSA9PT0gY29kZVN0ci5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgcmV0dXJuIHJvdztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBbZnJvbnQsIGJhY2tdID0gW3Jvdy5zbGljZSgwLCAtMSksIHJvdy5zbGljZSgtMSldO1xuICAgICAgICBpZiAoYmFjayA9PT0gJz8nKSB7XG4gICAgICAgICAgcmV0dXJuIGAke2Zyb250fV9gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9udCArIGJhY2sudG9VcHBlckNhc2UoKTtcbiAgICAgIH0pXG4gICAgICAuam9pbignJyk7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihjb2RlKSB7XG4gICAgY29uc3QgY29kZVN0ciA9IGNvZGUgfHwgJzAnO1xuICAgIHRoaXMuY29kZSA9IGNvZGVTdHJcbiAgICAgIC5zcGxpdCgvXFxyP1xcbi8pXG4gICAgICAubWFwKHJvdyA9PiBbLi4ucm93XS5tYXAoY2VsbCA9PiBQaWV0LmNoYXIyY29sb3JbY2VsbF0pKTtcbiAgICB0aGlzLnJvd3MgPSB0aGlzLmNvZGUubGVuZ3RoO1xuICAgIHRoaXMuY29scyA9IHRoaXMuY29kZVswXS5sZW5ndGg7XG4gIH1cblxuICBleHRlbmRDb2RlKGRpcmVjdGlvbikge1xuICAgIGlmIChkaXJlY3Rpb24gPT09ICdyJykge1xuICAgICAgdGhpcy5jb2RlLmZvckVhY2gocm93ID0+IHtcbiAgICAgICAgcm93LnB1c2goMTkpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbHMgKz0gMTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2wnKSB7XG4gICAgICB0aGlzLmNvZGUuZm9yRWFjaChyb3cgPT4ge1xuICAgICAgICByb3cudW5zaGlmdCgxOSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuY29scyArPSAxO1xuICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnZCcpIHtcbiAgICAgIHRoaXMuY29kZS5wdXNoKHRoaXMuY29kZVswXS5tYXAoKCkgPT4gMTkpKTtcbiAgICAgIHRoaXMucm93cyArPSAxO1xuICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAndScpIHtcbiAgICAgIHRoaXMuY29kZS51bnNoaWZ0KHRoaXMuY29kZVswXS5tYXAoKCkgPT4gMTkpKTtcbiAgICAgIHRoaXMucm93cyArPSAxO1xuICAgIH1cbiAgfVxuXG4gIHNocmlua0NvZGUoZGlyZWN0aW9uKSB7XG4gICAgaWYgKFxuICAgICAgKChkaXJlY3Rpb24gPT09ICdyJyB8fCBkaXJlY3Rpb24gPT09ICdsJykgJiYgdGhpcy5jb2xzID09PSAxKSB8fFxuICAgICAgKChkaXJlY3Rpb24gPT09ICd1JyB8fCBkaXJlY3Rpb24gPT09ICdkJykgJiYgdGhpcy5yb3dzID09PSAxKVxuICAgICkge1xuICAgICAgY29uc29sZS5sb2coJ0RpbWVuc2lvbiBjYW5ub3QgYmUgcmVkdWNlZCBmcm9tIDEnKTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3InKSB7XG4gICAgICB0aGlzLmNvZGUuZm9yRWFjaChyb3cgPT4ge1xuICAgICAgICByb3cucG9wKCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuY29scyAtPSAxO1xuICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbCcpIHtcbiAgICAgIHRoaXMuY29kZS5mb3JFYWNoKHJvdyA9PiB7XG4gICAgICAgIHJvdy5zaGlmdCgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbHMgLT0gMTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2QnKSB7XG4gICAgICB0aGlzLmNvZGUucG9wKCk7XG4gICAgICB0aGlzLnJvd3MgLT0gMTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3UnKSB7XG4gICAgICB0aGlzLmNvZGUuc2hpZnQoKTtcbiAgICAgIHRoaXMucm93cyAtPSAxO1xuICAgIH1cbiAgfVxuXG4gIHJlcGxhY2VDb2RlKG5ld0NvZGUpIHtcbiAgICB0aGlzLmNvZGUgPSBuZXdDb2RlO1xuICAgIHRoaXMucm93cyA9IHRoaXMuY29kZS5sZW5ndGg7XG4gICAgdGhpcy5jb2xzID0gdGhpcy5jb2RlWzBdLmxlbmd0aDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9