"use strict";
(self["webpackChunkpiet"] = self["webpackChunkpiet"] || []).push([["index"],{

/***/ "./node_modules/css-loader/dist/cjs.js!./src/index.css":
/*!*************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./src/index.css ***!
  \*************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/sourceMaps.js */ "./node_modules/css-loader/dist/runtime/sourceMaps.js");
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);
// Imports


var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));
// Module
___CSS_LOADER_EXPORT___.push([module.id, "svg {\n    margin: none;\n    padding: 2px;\n    border: 2px solid #ccc;\n}\n\n#svg-palette {\n    width: 368px;\n    height: 128px;\n}", "",{"version":3,"sources":["webpack://./src/index.css"],"names":[],"mappings":"AAAA;IACI,YAAY;IACZ,YAAY;IACZ,sBAAsB;AAC1B;;AAEA;IACI,YAAY;IACZ,aAAa;AACjB","sourcesContent":["svg {\n    margin: none;\n    padding: 2px;\n    border: 2px solid #ccc;\n}\n\n#svg-palette {\n    width: 368px;\n    height: 128px;\n}"],"sourceRoot":""}]);
// Exports
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);


/***/ }),

/***/ "./src/index.css":
/*!***********************!*\
  !*** ./src/index.css ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleDomAPI.js */ "./node_modules/style-loader/dist/runtime/styleDomAPI.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertBySelector.js */ "./node_modules/style-loader/dist/runtime/insertBySelector.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js */ "./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertStyleElement.js */ "./node_modules/style-loader/dist/runtime/insertStyleElement.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleTagTransform.js */ "./node_modules/style-loader/dist/runtime/styleTagTransform.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! !!../node_modules/css-loader/dist/cjs.js!./index.css */ "./node_modules/css-loader/dist/cjs.js!./src/index.css");

      
      
      
      
      
      
      
      
      

var options = {};

options.styleTagTransform = (_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default());
options.setAttributes = (_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default());

      options.insert = _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default().bind(null, "head");
    
options.domAPI = (_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default());
options.insertStyleElement = (_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default());

var update = _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"], options);




       /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"] && _node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals ? _node_modules_css_loader_dist_cjs_js_index_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals : undefined);


/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var bootstrap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bootstrap */ "./node_modules/bootstrap/dist/js/bootstrap.esm.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! snapsvg */ "./node_modules/snapsvg/dist/snap.svg.js");
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(snapsvg__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _piet_ui_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./piet-ui.js */ "./src/piet-ui.js");
/* harmony import */ var bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! bootstrap/dist/css/bootstrap.min.css */ "./node_modules/bootstrap/dist/css/bootstrap.min.css");
/* harmony import */ var bootstrap_icons_font_bootstrap_icons_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bootstrap-icons/font/bootstrap-icons.css */ "./node_modules/bootstrap-icons/font/bootstrap-icons.css");
/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./index.css */ "./src/index.css");








function init() {
  const ui = new _piet_ui_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
}

window.onload = () => {
  init();
  console.log('loaded');
};


/***/ }),

/***/ "./src/piet-ui.js":
/*!************************!*\
  !*** ./src/piet-ui.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ PietUI)
/* harmony export */ });
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! snapsvg */ "./node_modules/snapsvg/dist/snap.svg.js");
/* harmony import */ var snapsvg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(snapsvg__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _piet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./piet.js */ "./src/piet.js");




class PietUI {
  constructor(code) {
    _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].initialize();
    this.paletteSvg = snapsvg__WEBPACK_IMPORTED_MODULE_0___default()('#svg-palette');
    this.paletteRects = [];
    this.paletteOverlays = [];
    for (let light = 0; light < 3; light += 1) {
      this.paletteOverlays.push([]);
      for (let hue = 0; hue < 6; hue += 1) {
        const color = light * 6 + hue;
        const curRect = this.paletteSvg.el('rect', {
          width: 60,
          height: 30,
          x: 60 * hue,
          y: 30 * light,
          fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[color].colorcode,
        });
        this.paletteRects.push(curRect);
        const curCmd = this.paletteSvg
          .text(60 * hue + 30, 30 * light + 15, '')
          .attr({
            'text-anchor': 'middle',
            'dominant-baseline': 'middle',
            'pointer-events': 'none',
          });
        if (hue === 4 && light >= 1) {
          curCmd.attr({ fill: 'white' });
        } else {
          curCmd.attr({ fill: 'black' });
        }
        this.paletteOverlays[light].push(curCmd);
        this.paletteSvg.g(curRect, curCmd).click(e => {
          e.stopPropagation();
          e.preventDefault();
          console.log(e);
          console.log(color);
          this.edit.updateColor(color);
        });
      }
    }
    for (let color = 18; color <= 19; color += 1) {
      const curRect = this.paletteSvg
        .el('rect', {
          width: 180,
          height: 30,
          x: 180 * (color - 18),
          y: 90,
          fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[color].colorcode,
        })
        .click(e => {
          e.stopPropagation();
          e.preventDefault();
          console.log(e);
          console.log(color);
          this.edit.updateColor(color);
        });
      this.paletteRects.push(curRect);
    }
    this.codeSvg = snapsvg__WEBPACK_IMPORTED_MODULE_0___default()('#svg-code');
    this.code = new _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"](code);
    const codeRect = this.codeSvg
      .el('rect', { width: 30, height: 30 })
      .toDefs();
    this.codeRects = [[]];
    this.codeRects.update = () => {
      const prevRows = this.codeRects.length;
      const prevCols = this.codeRects[0].length;
      if (prevRows < this.code.rows) {
        const newRow = this.code.code[this.code.rows - 1].map((color, c) => {
          const curRect = this.codeSvg.use(codeRect);
          return curRect.attr({
            x: 30 * c,
            y: 30 * (this.code.rows - 1),
            fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[color].colorcode,
          });
        });
        this.codeRects.push(newRow);
      } else if (prevRows > this.code.rows) {
        this.codeRects.pop().forEach(rect => rect.remove());
      }
      if (prevCols < this.code.cols) {
        this.codeRects.forEach((row, r) => {
          const newRect = this.codeSvg.use(codeRect);
          newRect.attr({
            x: 30 * (this.code.cols - 1),
            y: 30 * r,
            fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[this.code.code[r][this.code.cols - 1]].colorcode,
          });
          row.push(newRect);
        });
      } else if (prevCols > this.code.cols) {
        this.codeRects.forEach(row => row.pop().remove());
      }
      this.codeRects.forEach((row, r) => {
        row.forEach((rect, c) => {
          rect.attr({ fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[this.code.code[r][c]].colorcode });
        });
      });
      this.codeSvg.attr({
        width: 30 * this.code.cols + 8,
        height: 30 * this.code.rows + 8,
      });
    };
    this.codeRects.update();
    this.edit = {
      mode: 'write',
      color: 0,
      selectColor: clr => {
        this.paletteRects[clr].attr({
          stroke: 'gray',
          'stroke-width': 6,
          x: '+=3',
          y: '+=3',
          width: '-=6',
          height: '-=6',
        });
        if (clr < 18) {
          const curHue = clr % 6;
          const curLight = (clr / 6) | 0;
          for (let lightOff = 0; lightOff < 3; lightOff += 1) {
            for (let hueOff = 0; hueOff < 6; hueOff += 1) {
              const s = _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].commandText[lightOff][hueOff];
              const nextHue = (curHue + hueOff) % 6;
              const nextLight = (curLight + lightOff) % 3;
              this.paletteOverlays[nextLight][nextHue].node.textContent = s;
            }
          }
        } else {
          for (let light = 0; light < 3; light += 1) {
            for (let hue = 0; hue < 6; hue += 1) {
              this.paletteOverlays[light][hue].node.textContent = '';
            }
          }
        }
      },
      unselectColor: clr => {
        this.paletteRects[clr].attr({
          stroke: undefined,
          'stroke-width': undefined,
          x: '-=3',
          y: '-=3',
          width: '+=6',
          height: '+=6',
        });
      },
      updateColor: clr => {
        const prevColor = this.edit.color;
        this.edit.color = clr;
        this.edit.unselectColor(prevColor);
        this.edit.selectColor(clr);
      },
      updateCodeColor1: (r, c, clr) => {
        this.code.code[r][c] = clr;
        this.codeRects[r][c].attr({ fill: _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[clr].colorcode });
      },
    };
    this.edit.selectColor(0);

    ['l', 'u', 'r', 'd'].forEach(direction => {
      ['plus', 'minus'].forEach(action => {
        const id = `#grid-${direction}${action}`;
        const button = jquery__WEBPACK_IMPORTED_MODULE_1___default()(id);
        button.on('click', e => {
          e.stopPropagation();
          e.preventDefault();
          if (action === 'plus') {
            this.code.extendCode(direction);
          } else {
            this.code.shrinkCode(direction);
          }
          this.codeRects.update();
        });
      });
    });

    const writeButton = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#grid-write');
    const pickButton = jquery__WEBPACK_IMPORTED_MODULE_1___default()('#grid-pick');
    writeButton.on('click', () => {
      this.codeSvg.unclick();
      this.codeSvg.drag(
        (dx, dy, x, y, e) => {
          const curR = ((e.offsetY - 3) / 30) | 0;
          const curC = ((e.offsetX - 3) / 30) | 0;
          if (
            curR >= 0 &&
            curR < this.code.rows &&
            curC >= 0 &&
            curC < this.code.cols
          ) {
            this.edit.updateCodeColor1(curR, curC, this.edit.color);
          }
        },
        (x, y, e) => {
          const curR = ((e.offsetY - 3) / 30) | 0;
          const curC = ((e.offsetX - 3) / 30) | 0;
          if (
            curR >= 0 &&
            curR < this.code.rows &&
            curC >= 0 &&
            curC < this.code.cols
          ) {
            this.edit.updateCodeColor1(curR, curC, this.edit.color);
          }
        },
        () => {},
      );
    });
    pickButton.on('click', () => {
      this.codeSvg.undrag();
      this.codeSvg.click(e => {
        const curR = ((e.offsetY - 3) / 30) | 0;
        const curC = ((e.offsetX - 3) / 30) | 0;
        if (
          curR >= 0 &&
          curR < this.code.rows &&
          curC >= 0 &&
          curC < this.code.cols
        ) {
          this.edit.updateColor(this.code.code[curR][curC]);
        }
      });
    });
    writeButton.trigger('click');

    this.export = {
      pngButton: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#export-png'),
      svgButton: jquery__WEBPACK_IMPORTED_MODULE_1___default()('#export-svg'),
      updateExportLink: () => {
        const { rows, cols } = this.code;
        const matrix = this.code.code;
        const canvas = jquery__WEBPACK_IMPORTED_MODULE_1___default()('<canvas/>');
        canvas.prop({ width: cols, height: rows });
        const canvasEl = canvas.get(0);
        const ctx = canvasEl.getContext('2d');
        const imdata = ctx.getImageData(0, 0, cols, rows);
        for (let r = 0; r < rows; r += 1) {
          for (let c = 0; c < cols; c += 1) {
            const idx = (r * cols + c) * 4;
            const { colorvec } = _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[matrix[r][c]];
            console.log(_piet_js__WEBPACK_IMPORTED_MODULE_2__["default"], _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors, _piet_js__WEBPACK_IMPORTED_MODULE_2__["default"].colors[matrix[r][c]], colorvec);
            for (let i = 0; i < 4; i += 1) {
              imdata.data[idx + i] = colorvec[i];
            }
          }
        }
        ctx.putImageData(imdata, 0, 0);
        canvasEl.toBlob(blob => {
          const pngUrl = URL.createObjectURL(blob);
          this.export.pngButton.prop({ href: pngUrl });
        });
        // const pngUrl = canvasEl.toDataURL('image/png');
        // this.export.pngButton.prop({ href: pngUrl });
        const svgStr = this.codeSvg
          .outerSVG()
          .replace('<svg', '<svg xmlns="http://www.w3.org/2000/svg"');
        const svgBlob = new Blob([svgStr]);
        const svgUrl = URL.createObjectURL(svgBlob);
        this.export.svgButton.prop({ href: svgUrl });
      },
    };
    jquery__WEBPACK_IMPORTED_MODULE_1___default()('#nav-share-tab').on('click', () => {
      this.export.updateExportLink();
    });
  }
}


/***/ }),

/***/ "./src/piet.js":
/*!*********************!*\
  !*** ./src/piet.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Piet)
/* harmony export */ });
class Piet {
  static commandText = [
    ['', '+', '/', '<', 'dup', 'inC'],
    ['push', '-', '%', 'DP+', 'roll', 'outN'],
    ['pop', '*', '!', 'CC+', 'inN', 'outC'],
  ];

  static initialize() {
    this.char2color = {};
    this.colors = [];
    const hueMask = [4, 6, 2, 3, 1, 5];
    const lightStr = [
      ['C0', 'FF'],
      ['00', 'FF'],
      ['00', 'C0'],
    ];
    for (let darkness = 0; darkness < 3; darkness += 1) {
      const light = lightStr[darkness];
      for (let hue = 0; hue < 6; hue += 1) {
        const charcode = darkness * 32 + hue + 48;
        let colorcode = '#';
        const colorvec = [];
        for (let i = 0; i < 3; i += 1) {
          const nextVal = light[(hueMask[hue] >> (2 - i)) & 1];
          colorcode += nextVal;
          colorvec.push(Number.parseInt(nextVal, 16));
        }
        colorvec.push(255);
        const char = String.fromCharCode(charcode);
        this.colors.push({ charcode, char, colorcode, colorvec });
        this.char2color[char] = darkness * 6 + hue;
      }
    }
    this.colors.push({
      charcode: '@'.charCodeAt(),
      char: '@',
      colorcode: '#FFFFFF',
      colorvec: [255, 255, 255, 255],
    });
    this.char2color['@'] = 18;
    this.colors.push({
      charcode: ' '.charCodeAt(),
      char: ' ',
      colorcode: '#000000',
      colorvec: [0, 0, 0, 255],
    });
    this.char2color[' '] = 19;
  }

  constructor(code) {
    const codeStr = code || '0';
    this.code = codeStr
      .split(/\r?\n/)
      .map(row => [...row].map(cell => Piet.char2color[cell]));
    this.rows = this.code.length;
    this.cols = this.code[0].length;
  }

  extendCode(direction) {
    if (direction === 'r') {
      this.code.forEach(row => {
        row.push(19);
      });
      this.cols += 1;
    } else if (direction === 'l') {
      this.code.forEach(row => {
        row.unshift(19);
      });
      this.cols += 1;
    } else if (direction === 'd') {
      this.code.push(this.code[0].map(() => 19));
      this.rows += 1;
    } else if (direction === 'u') {
      this.code.unshift(this.code[0].map(() => 19));
      this.rows += 1;
    }
  }

  shrinkCode(direction) {
    if (
      ((direction === 'r' || direction === 'l') && this.cols === 1) ||
      ((direction === 'u' || direction === 'd') && this.rows === 1)
    ) {
      console.log('Dimension cannot be reduced from 1');
    } else if (direction === 'r') {
      this.code.forEach(row => {
        row.pop();
      });
      this.cols -= 1;
    } else if (direction === 'l') {
      this.code.forEach(row => {
        row.shift();
      });
      this.cols -= 1;
    } else if (direction === 'd') {
      this.code.pop();
      this.rows -= 1;
    } else if (direction === 'u') {
      this.code.shift();
      this.rows -= 1;
    }
  }
}


/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%272%27 fill=%27%23fff%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e":
/*!*********************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e ***!
  \*********************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%2386b7fe%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27%23fff%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e":
/*!***********************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e ***!
  \***********************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%27-4 -4 8 8%27%3e%3ccircle r=%273%27 fill=%27rgba%280, 0, 0, 0.25%29%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 12 12%27 width=%2712%27 height=%2712%27 fill=%27none%27 stroke=%27%23dc3545%27%3e%3ccircle cx=%276%27 cy=%276%27 r=%274.5%27/%3e%3cpath stroke-linejoin=%27round%27 d=%27M5.8 3.6h.4L6 6.5z%27/%3e%3ccircle cx=%276%27 cy=%278.2%27 r=%27.6%27 fill=%27%23dc3545%27 stroke=%27none%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23000%27%3e%3cpath d=%27M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%230c63e4%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%230c63e4%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%230c63e4%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23212529%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23212529%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23212529%27%3e%3cpath fill-rule=%27evenodd%27 d=%27M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e":
/*!************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e ***!
  \************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e":
/*!*************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e ***!
  \*************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27 fill=%27%23fff%27%3e%3cpath d=%27M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M2 5l6 6 6-6%27/%3e%3c/svg%3e":
/*!****************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M2 5l6 6 6-6%27/%3e%3c/svg%3e ***!
  \****************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M2 5l6 6 6-6%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e":
/*!********************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e ***!
  \********************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10h8%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10l3 3l6-6%27/%3e%3c/svg%3e":
/*!**************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10l3 3l6-6%27/%3e%3c/svg%3e ***!
  \**************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3e%3cpath fill=%27none%27 stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%273%27 d=%27M6 10l3 3l6-6%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%280, 0, 0, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e":
/*!************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%280, 0, 0, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e ***!
  \************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%280, 0, 0, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e":
/*!******************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e ***!
  \******************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 30 30%27%3e%3cpath stroke=%27rgba%28255, 255, 255, 0.55%29%27 stroke-linecap=%27round%27 stroke-miterlimit=%2710%27 stroke-width=%272%27 d=%27M4 7h22M4 15h22M4 23h22%27/%3e%3c/svg%3e";

/***/ }),

/***/ "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e":
/*!***********************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e ***!
  \***********************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 8 8%27%3e%3cpath fill=%27%23198754%27 d=%27M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z%27/%3e%3c/svg%3e";

/***/ })

},
/******/ __webpack_require__ => { // webpackRuntimeModules
/******/ var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
/******/ __webpack_require__.O(0, ["vendors"], () => (__webpack_exec__("./src/index.js")));
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ }
]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguOWJlMjg4ZjBmZGQ1YjgxOTkyNTcuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDMEc7QUFDakI7QUFDekYsOEJBQThCLG1GQUEyQixDQUFDLDRGQUFxQztBQUMvRjtBQUNBLCtDQUErQyxtQkFBbUIsbUJBQW1CLDZCQUE2QixHQUFHLGtCQUFrQixtQkFBbUIsb0JBQW9CLEdBQUcsT0FBTyxnRkFBZ0YsVUFBVSxVQUFVLFlBQVksT0FBTyxLQUFLLFVBQVUsVUFBVSwrQkFBK0IsbUJBQW1CLG1CQUFtQiw2QkFBNkIsR0FBRyxrQkFBa0IsbUJBQW1CLG9CQUFvQixHQUFHLG1CQUFtQjtBQUM1ZjtBQUNBLGlFQUFlLHVCQUF1QixFQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ052QyxNQUErRjtBQUMvRixNQUFxRjtBQUNyRixNQUE0RjtBQUM1RixNQUErRztBQUMvRyxNQUF3RztBQUN4RyxNQUF3RztBQUN4RyxNQUFtRztBQUNuRztBQUNBOztBQUVBOztBQUVBLDRCQUE0QixxR0FBbUI7QUFDL0Msd0JBQXdCLGtIQUFhOztBQUVyQyx1QkFBdUIsdUdBQWE7QUFDcEM7QUFDQSxpQkFBaUIsK0ZBQU07QUFDdkIsNkJBQTZCLHNHQUFrQjs7QUFFL0MsYUFBYSwwR0FBRyxDQUFDLHNGQUFPOzs7O0FBSTZDO0FBQ3JFLE9BQU8saUVBQWUsc0ZBQU8sSUFBSSw2RkFBYyxHQUFHLDZGQUFjLFlBQVksRUFBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDMUJ0QztBQUNoQjtBQUNJO0FBQ087QUFDWTtBQUNJO0FBQzdCOztBQUVyQjtBQUNBLGlCQUFpQixtREFBTTtBQUN2Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNmMkI7QUFDSjtBQUNNOztBQUVkO0FBQ2Y7QUFDQSxJQUFJLDJEQUFlO0FBQ25CLHNCQUFzQiw4Q0FBSTtBQUMxQjtBQUNBO0FBQ0Esd0JBQXdCLFdBQVc7QUFDbkM7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L3NyYy9pbmRleC5jc3M/Y2ZlNCIsIndlYnBhY2s6Ly9waWV0Ly4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3BpZXQvLi9zcmMvcGlldC11aS5qcyIsIndlYnBhY2s6Ly9waWV0Ly4vc3JjL3BpZXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gSW1wb3J0c1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX1NPVVJDRU1BUF9JTVBPUlRfX18gZnJvbSBcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9zb3VyY2VNYXBzLmpzXCI7XG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fIGZyb20gXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCI7XG52YXIgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18gPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyk7XG4vLyBNb2R1bGVcbl9fX0NTU19MT0FERVJfRVhQT1JUX19fLnB1c2goW21vZHVsZS5pZCwgXCJzdmcge1xcbiAgICBtYXJnaW46IG5vbmU7XFxuICAgIHBhZGRpbmc6IDJweDtcXG4gICAgYm9yZGVyOiAycHggc29saWQgI2NjYztcXG59XFxuXFxuI3N2Zy1wYWxldHRlIHtcXG4gICAgd2lkdGg6IDM2OHB4O1xcbiAgICBoZWlnaHQ6IDEyOHB4O1xcbn1cIiwgXCJcIix7XCJ2ZXJzaW9uXCI6MyxcInNvdXJjZXNcIjpbXCJ3ZWJwYWNrOi8vLi9zcmMvaW5kZXguY3NzXCJdLFwibmFtZXNcIjpbXSxcIm1hcHBpbmdzXCI6XCJBQUFBO0lBQ0ksWUFBWTtJQUNaLFlBQVk7SUFDWixzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxZQUFZO0lBQ1osYUFBYTtBQUNqQlwiLFwic291cmNlc0NvbnRlbnRcIjpbXCJzdmcge1xcbiAgICBtYXJnaW46IG5vbmU7XFxuICAgIHBhZGRpbmc6IDJweDtcXG4gICAgYm9yZGVyOiAycHggc29saWQgI2NjYztcXG59XFxuXFxuI3N2Zy1wYWxldHRlIHtcXG4gICAgd2lkdGg6IDM2OHB4O1xcbiAgICBoZWlnaHQ6IDEyOHB4O1xcbn1cIl0sXCJzb3VyY2VSb290XCI6XCJcIn1dKTtcbi8vIEV4cG9ydHNcbmV4cG9ydCBkZWZhdWx0IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuIiwiXG4gICAgICBpbXBvcnQgQVBJIGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCI7XG4gICAgICBpbXBvcnQgZG9tQVBJIGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVEb21BUEkuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRGbiBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydEJ5U2VsZWN0b3IuanNcIjtcbiAgICAgIGltcG9ydCBzZXRBdHRyaWJ1dGVzIGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc2V0QXR0cmlidXRlc1dpdGhvdXRBdHRyaWJ1dGVzLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0U3R5bGVFbGVtZW50IGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0U3R5bGVFbGVtZW50LmpzXCI7XG4gICAgICBpbXBvcnQgc3R5bGVUYWdUcmFuc2Zvcm1GbiBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlVGFnVHJhbnNmb3JtLmpzXCI7XG4gICAgICBpbXBvcnQgY29udGVudCwgKiBhcyBuYW1lZEV4cG9ydCBmcm9tIFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL2luZGV4LmNzc1wiO1xuICAgICAgXG4gICAgICBcblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5zdHlsZVRhZ1RyYW5zZm9ybSA9IHN0eWxlVGFnVHJhbnNmb3JtRm47XG5vcHRpb25zLnNldEF0dHJpYnV0ZXMgPSBzZXRBdHRyaWJ1dGVzO1xuXG4gICAgICBvcHRpb25zLmluc2VydCA9IGluc2VydEZuLmJpbmQobnVsbCwgXCJoZWFkXCIpO1xuICAgIFxub3B0aW9ucy5kb21BUEkgPSBkb21BUEk7XG5vcHRpb25zLmluc2VydFN0eWxlRWxlbWVudCA9IGluc2VydFN0eWxlRWxlbWVudDtcblxudmFyIHVwZGF0ZSA9IEFQSShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbmV4cG9ydCAqIGZyb20gXCIhIS4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vaW5kZXguY3NzXCI7XG4gICAgICAgZXhwb3J0IGRlZmF1bHQgY29udGVudCAmJiBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDogdW5kZWZpbmVkO1xuIiwiaW1wb3J0ICogYXMgYm9vdHN0cmFwIGZyb20gJ2Jvb3RzdHJhcCc7XG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IFNuYXAgZnJvbSAnc25hcHN2Zyc7XG5pbXBvcnQgUGlldFVJIGZyb20gJy4vcGlldC11aS5qcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC9kaXN0L2Nzcy9ib290c3RyYXAubWluLmNzcyc7XG5pbXBvcnQgJ2Jvb3RzdHJhcC1pY29ucy9mb250L2Jvb3RzdHJhcC1pY29ucy5jc3MnO1xuaW1wb3J0ICcuL2luZGV4LmNzcyc7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gIGNvbnN0IHVpID0gbmV3IFBpZXRVSSgpO1xufVxuXG53aW5kb3cub25sb2FkID0gKCkgPT4ge1xuICBpbml0KCk7XG4gIGNvbnNvbGUubG9nKCdsb2FkZWQnKTtcbn07XG4iLCJpbXBvcnQgU25hcCBmcm9tICdzbmFwc3ZnJztcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgUGlldCBmcm9tICcuL3BpZXQuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQaWV0VUkge1xuICBjb25zdHJ1Y3Rvcihjb2RlKSB7XG4gICAgUGlldC5pbml0aWFsaXplKCk7XG4gICAgdGhpcy5wYWxldHRlU3ZnID0gU25hcCgnI3N2Zy1wYWxldHRlJyk7XG4gICAgdGhpcy5wYWxldHRlUmVjdHMgPSBbXTtcbiAgICB0aGlzLnBhbGV0dGVPdmVybGF5cyA9IFtdO1xuICAgIGZvciAobGV0IGxpZ2h0ID0gMDsgbGlnaHQgPCAzOyBsaWdodCArPSAxKSB7XG4gICAgICB0aGlzLnBhbGV0dGVPdmVybGF5cy5wdXNoKFtdKTtcbiAgICAgIGZvciAobGV0IGh1ZSA9IDA7IGh1ZSA8IDY7IGh1ZSArPSAxKSB7XG4gICAgICAgIGNvbnN0IGNvbG9yID0gbGlnaHQgKiA2ICsgaHVlO1xuICAgICAgICBjb25zdCBjdXJSZWN0ID0gdGhpcy5wYWxldHRlU3ZnLmVsKCdyZWN0Jywge1xuICAgICAgICAgIHdpZHRoOiA2MCxcbiAgICAgICAgICBoZWlnaHQ6IDMwLFxuICAgICAgICAgIHg6IDYwICogaHVlLFxuICAgICAgICAgIHk6IDMwICogbGlnaHQsXG4gICAgICAgICAgZmlsbDogUGlldC5jb2xvcnNbY29sb3JdLmNvbG9yY29kZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucGFsZXR0ZVJlY3RzLnB1c2goY3VyUmVjdCk7XG4gICAgICAgIGNvbnN0IGN1ckNtZCA9IHRoaXMucGFsZXR0ZVN2Z1xuICAgICAgICAgIC50ZXh0KDYwICogaHVlICsgMzAsIDMwICogbGlnaHQgKyAxNSwgJycpXG4gICAgICAgICAgLmF0dHIoe1xuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogJ21pZGRsZScsXG4gICAgICAgICAgICAnZG9taW5hbnQtYmFzZWxpbmUnOiAnbWlkZGxlJyxcbiAgICAgICAgICAgICdwb2ludGVyLWV2ZW50cyc6ICdub25lJyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgaWYgKGh1ZSA9PT0gNCAmJiBsaWdodCA+PSAxKSB7XG4gICAgICAgICAgY3VyQ21kLmF0dHIoeyBmaWxsOiAnd2hpdGUnIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1ckNtZC5hdHRyKHsgZmlsbDogJ2JsYWNrJyB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhbGV0dGVPdmVybGF5c1tsaWdodF0ucHVzaChjdXJDbWQpO1xuICAgICAgICB0aGlzLnBhbGV0dGVTdmcuZyhjdXJSZWN0LCBjdXJDbWQpLmNsaWNrKGUgPT4ge1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGNvbG9yKTtcbiAgICAgICAgICB0aGlzLmVkaXQudXBkYXRlQ29sb3IoY29sb3IpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yIChsZXQgY29sb3IgPSAxODsgY29sb3IgPD0gMTk7IGNvbG9yICs9IDEpIHtcbiAgICAgIGNvbnN0IGN1clJlY3QgPSB0aGlzLnBhbGV0dGVTdmdcbiAgICAgICAgLmVsKCdyZWN0Jywge1xuICAgICAgICAgIHdpZHRoOiAxODAsXG4gICAgICAgICAgaGVpZ2h0OiAzMCxcbiAgICAgICAgICB4OiAxODAgKiAoY29sb3IgLSAxOCksXG4gICAgICAgICAgeTogOTAsXG4gICAgICAgICAgZmlsbDogUGlldC5jb2xvcnNbY29sb3JdLmNvbG9yY29kZSxcbiAgICAgICAgfSlcbiAgICAgICAgLmNsaWNrKGUgPT4ge1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGNvbG9yKTtcbiAgICAgICAgICB0aGlzLmVkaXQudXBkYXRlQ29sb3IoY29sb3IpO1xuICAgICAgICB9KTtcbiAgICAgIHRoaXMucGFsZXR0ZVJlY3RzLnB1c2goY3VyUmVjdCk7XG4gICAgfVxuICAgIHRoaXMuY29kZVN2ZyA9IFNuYXAoJyNzdmctY29kZScpO1xuICAgIHRoaXMuY29kZSA9IG5ldyBQaWV0KGNvZGUpO1xuICAgIGNvbnN0IGNvZGVSZWN0ID0gdGhpcy5jb2RlU3ZnXG4gICAgICAuZWwoJ3JlY3QnLCB7IHdpZHRoOiAzMCwgaGVpZ2h0OiAzMCB9KVxuICAgICAgLnRvRGVmcygpO1xuICAgIHRoaXMuY29kZVJlY3RzID0gW1tdXTtcbiAgICB0aGlzLmNvZGVSZWN0cy51cGRhdGUgPSAoKSA9PiB7XG4gICAgICBjb25zdCBwcmV2Um93cyA9IHRoaXMuY29kZVJlY3RzLmxlbmd0aDtcbiAgICAgIGNvbnN0IHByZXZDb2xzID0gdGhpcy5jb2RlUmVjdHNbMF0ubGVuZ3RoO1xuICAgICAgaWYgKHByZXZSb3dzIDwgdGhpcy5jb2RlLnJvd3MpIHtcbiAgICAgICAgY29uc3QgbmV3Um93ID0gdGhpcy5jb2RlLmNvZGVbdGhpcy5jb2RlLnJvd3MgLSAxXS5tYXAoKGNvbG9yLCBjKSA9PiB7XG4gICAgICAgICAgY29uc3QgY3VyUmVjdCA9IHRoaXMuY29kZVN2Zy51c2UoY29kZVJlY3QpO1xuICAgICAgICAgIHJldHVybiBjdXJSZWN0LmF0dHIoe1xuICAgICAgICAgICAgeDogMzAgKiBjLFxuICAgICAgICAgICAgeTogMzAgKiAodGhpcy5jb2RlLnJvd3MgLSAxKSxcbiAgICAgICAgICAgIGZpbGw6IFBpZXQuY29sb3JzW2NvbG9yXS5jb2xvcmNvZGUsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvZGVSZWN0cy5wdXNoKG5ld1Jvdyk7XG4gICAgICB9IGVsc2UgaWYgKHByZXZSb3dzID4gdGhpcy5jb2RlLnJvd3MpIHtcbiAgICAgICAgdGhpcy5jb2RlUmVjdHMucG9wKCkuZm9yRWFjaChyZWN0ID0+IHJlY3QucmVtb3ZlKCkpO1xuICAgICAgfVxuICAgICAgaWYgKHByZXZDb2xzIDwgdGhpcy5jb2RlLmNvbHMpIHtcbiAgICAgICAgdGhpcy5jb2RlUmVjdHMuZm9yRWFjaCgocm93LCByKSA9PiB7XG4gICAgICAgICAgY29uc3QgbmV3UmVjdCA9IHRoaXMuY29kZVN2Zy51c2UoY29kZVJlY3QpO1xuICAgICAgICAgIG5ld1JlY3QuYXR0cih7XG4gICAgICAgICAgICB4OiAzMCAqICh0aGlzLmNvZGUuY29scyAtIDEpLFxuICAgICAgICAgICAgeTogMzAgKiByLFxuICAgICAgICAgICAgZmlsbDogUGlldC5jb2xvcnNbdGhpcy5jb2RlLmNvZGVbcl1bdGhpcy5jb2RlLmNvbHMgLSAxXV0uY29sb3Jjb2RlLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJvdy5wdXNoKG5ld1JlY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAocHJldkNvbHMgPiB0aGlzLmNvZGUuY29scykge1xuICAgICAgICB0aGlzLmNvZGVSZWN0cy5mb3JFYWNoKHJvdyA9PiByb3cucG9wKCkucmVtb3ZlKCkpO1xuICAgICAgfVxuICAgICAgdGhpcy5jb2RlUmVjdHMuZm9yRWFjaCgocm93LCByKSA9PiB7XG4gICAgICAgIHJvdy5mb3JFYWNoKChyZWN0LCBjKSA9PiB7XG4gICAgICAgICAgcmVjdC5hdHRyKHsgZmlsbDogUGlldC5jb2xvcnNbdGhpcy5jb2RlLmNvZGVbcl1bY11dLmNvbG9yY29kZSB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuY29kZVN2Zy5hdHRyKHtcbiAgICAgICAgd2lkdGg6IDMwICogdGhpcy5jb2RlLmNvbHMgKyA4LFxuICAgICAgICBoZWlnaHQ6IDMwICogdGhpcy5jb2RlLnJvd3MgKyA4LFxuICAgICAgfSk7XG4gICAgfTtcbiAgICB0aGlzLmNvZGVSZWN0cy51cGRhdGUoKTtcbiAgICB0aGlzLmVkaXQgPSB7XG4gICAgICBtb2RlOiAnd3JpdGUnLFxuICAgICAgY29sb3I6IDAsXG4gICAgICBzZWxlY3RDb2xvcjogY2xyID0+IHtcbiAgICAgICAgdGhpcy5wYWxldHRlUmVjdHNbY2xyXS5hdHRyKHtcbiAgICAgICAgICBzdHJva2U6ICdncmF5JyxcbiAgICAgICAgICAnc3Ryb2tlLXdpZHRoJzogNixcbiAgICAgICAgICB4OiAnKz0zJyxcbiAgICAgICAgICB5OiAnKz0zJyxcbiAgICAgICAgICB3aWR0aDogJy09NicsXG4gICAgICAgICAgaGVpZ2h0OiAnLT02JyxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjbHIgPCAxOCkge1xuICAgICAgICAgIGNvbnN0IGN1ckh1ZSA9IGNsciAlIDY7XG4gICAgICAgICAgY29uc3QgY3VyTGlnaHQgPSAoY2xyIC8gNikgfCAwO1xuICAgICAgICAgIGZvciAobGV0IGxpZ2h0T2ZmID0gMDsgbGlnaHRPZmYgPCAzOyBsaWdodE9mZiArPSAxKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBodWVPZmYgPSAwOyBodWVPZmYgPCA2OyBodWVPZmYgKz0gMSkge1xuICAgICAgICAgICAgICBjb25zdCBzID0gUGlldC5jb21tYW5kVGV4dFtsaWdodE9mZl1baHVlT2ZmXTtcbiAgICAgICAgICAgICAgY29uc3QgbmV4dEh1ZSA9IChjdXJIdWUgKyBodWVPZmYpICUgNjtcbiAgICAgICAgICAgICAgY29uc3QgbmV4dExpZ2h0ID0gKGN1ckxpZ2h0ICsgbGlnaHRPZmYpICUgMztcbiAgICAgICAgICAgICAgdGhpcy5wYWxldHRlT3ZlcmxheXNbbmV4dExpZ2h0XVtuZXh0SHVlXS5ub2RlLnRleHRDb250ZW50ID0gcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yIChsZXQgbGlnaHQgPSAwOyBsaWdodCA8IDM7IGxpZ2h0ICs9IDEpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGh1ZSA9IDA7IGh1ZSA8IDY7IGh1ZSArPSAxKSB7XG4gICAgICAgICAgICAgIHRoaXMucGFsZXR0ZU92ZXJsYXlzW2xpZ2h0XVtodWVdLm5vZGUudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1bnNlbGVjdENvbG9yOiBjbHIgPT4ge1xuICAgICAgICB0aGlzLnBhbGV0dGVSZWN0c1tjbHJdLmF0dHIoe1xuICAgICAgICAgIHN0cm9rZTogdW5kZWZpbmVkLFxuICAgICAgICAgICdzdHJva2Utd2lkdGgnOiB1bmRlZmluZWQsXG4gICAgICAgICAgeDogJy09MycsXG4gICAgICAgICAgeTogJy09MycsXG4gICAgICAgICAgd2lkdGg6ICcrPTYnLFxuICAgICAgICAgIGhlaWdodDogJys9NicsXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIHVwZGF0ZUNvbG9yOiBjbHIgPT4ge1xuICAgICAgICBjb25zdCBwcmV2Q29sb3IgPSB0aGlzLmVkaXQuY29sb3I7XG4gICAgICAgIHRoaXMuZWRpdC5jb2xvciA9IGNscjtcbiAgICAgICAgdGhpcy5lZGl0LnVuc2VsZWN0Q29sb3IocHJldkNvbG9yKTtcbiAgICAgICAgdGhpcy5lZGl0LnNlbGVjdENvbG9yKGNscik7XG4gICAgICB9LFxuICAgICAgdXBkYXRlQ29kZUNvbG9yMTogKHIsIGMsIGNscikgPT4ge1xuICAgICAgICB0aGlzLmNvZGUuY29kZVtyXVtjXSA9IGNscjtcbiAgICAgICAgdGhpcy5jb2RlUmVjdHNbcl1bY10uYXR0cih7IGZpbGw6IFBpZXQuY29sb3JzW2Nscl0uY29sb3Jjb2RlIH0pO1xuICAgICAgfSxcbiAgICB9O1xuICAgIHRoaXMuZWRpdC5zZWxlY3RDb2xvcigwKTtcblxuICAgIFsnbCcsICd1JywgJ3InLCAnZCddLmZvckVhY2goZGlyZWN0aW9uID0+IHtcbiAgICAgIFsncGx1cycsICdtaW51cyddLmZvckVhY2goYWN0aW9uID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSBgI2dyaWQtJHtkaXJlY3Rpb259JHthY3Rpb259YDtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gJChpZCk7XG4gICAgICAgIGJ1dHRvbi5vbignY2xpY2snLCBlID0+IHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBpZiAoYWN0aW9uID09PSAncGx1cycpIHtcbiAgICAgICAgICAgIHRoaXMuY29kZS5leHRlbmRDb2RlKGRpcmVjdGlvbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29kZS5zaHJpbmtDb2RlKGRpcmVjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuY29kZVJlY3RzLnVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgY29uc3Qgd3JpdGVCdXR0b24gPSAkKCcjZ3JpZC13cml0ZScpO1xuICAgIGNvbnN0IHBpY2tCdXR0b24gPSAkKCcjZ3JpZC1waWNrJyk7XG4gICAgd3JpdGVCdXR0b24ub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5jb2RlU3ZnLnVuY2xpY2soKTtcbiAgICAgIHRoaXMuY29kZVN2Zy5kcmFnKFxuICAgICAgICAoZHgsIGR5LCB4LCB5LCBlKSA9PiB7XG4gICAgICAgICAgY29uc3QgY3VyUiA9ICgoZS5vZmZzZXRZIC0gMykgLyAzMCkgfCAwO1xuICAgICAgICAgIGNvbnN0IGN1ckMgPSAoKGUub2Zmc2V0WCAtIDMpIC8gMzApIHwgMDtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBjdXJSID49IDAgJiZcbiAgICAgICAgICAgIGN1clIgPCB0aGlzLmNvZGUucm93cyAmJlxuICAgICAgICAgICAgY3VyQyA+PSAwICYmXG4gICAgICAgICAgICBjdXJDIDwgdGhpcy5jb2RlLmNvbHNcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdC51cGRhdGVDb2RlQ29sb3IxKGN1clIsIGN1ckMsIHRoaXMuZWRpdC5jb2xvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAoeCwgeSwgZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGN1clIgPSAoKGUub2Zmc2V0WSAtIDMpIC8gMzApIHwgMDtcbiAgICAgICAgICBjb25zdCBjdXJDID0gKChlLm9mZnNldFggLSAzKSAvIDMwKSB8IDA7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgY3VyUiA+PSAwICYmXG4gICAgICAgICAgICBjdXJSIDwgdGhpcy5jb2RlLnJvd3MgJiZcbiAgICAgICAgICAgIGN1ckMgPj0gMCAmJlxuICAgICAgICAgICAgY3VyQyA8IHRoaXMuY29kZS5jb2xzXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXQudXBkYXRlQ29kZUNvbG9yMShjdXJSLCBjdXJDLCB0aGlzLmVkaXQuY29sb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgKCkgPT4ge30sXG4gICAgICApO1xuICAgIH0pO1xuICAgIHBpY2tCdXR0b24ub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5jb2RlU3ZnLnVuZHJhZygpO1xuICAgICAgdGhpcy5jb2RlU3ZnLmNsaWNrKGUgPT4ge1xuICAgICAgICBjb25zdCBjdXJSID0gKChlLm9mZnNldFkgLSAzKSAvIDMwKSB8IDA7XG4gICAgICAgIGNvbnN0IGN1ckMgPSAoKGUub2Zmc2V0WCAtIDMpIC8gMzApIHwgMDtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGN1clIgPj0gMCAmJlxuICAgICAgICAgIGN1clIgPCB0aGlzLmNvZGUucm93cyAmJlxuICAgICAgICAgIGN1ckMgPj0gMCAmJlxuICAgICAgICAgIGN1ckMgPCB0aGlzLmNvZGUuY29sc1xuICAgICAgICApIHtcbiAgICAgICAgICB0aGlzLmVkaXQudXBkYXRlQ29sb3IodGhpcy5jb2RlLmNvZGVbY3VyUl1bY3VyQ10pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICB3cml0ZUJ1dHRvbi50cmlnZ2VyKCdjbGljaycpO1xuXG4gICAgdGhpcy5leHBvcnQgPSB7XG4gICAgICBwbmdCdXR0b246ICQoJyNleHBvcnQtcG5nJyksXG4gICAgICBzdmdCdXR0b246ICQoJyNleHBvcnQtc3ZnJyksXG4gICAgICB1cGRhdGVFeHBvcnRMaW5rOiAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgcm93cywgY29scyB9ID0gdGhpcy5jb2RlO1xuICAgICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmNvZGUuY29kZTtcbiAgICAgICAgY29uc3QgY2FudmFzID0gJCgnPGNhbnZhcy8+Jyk7XG4gICAgICAgIGNhbnZhcy5wcm9wKHsgd2lkdGg6IGNvbHMsIGhlaWdodDogcm93cyB9KTtcbiAgICAgICAgY29uc3QgY2FudmFzRWwgPSBjYW52YXMuZ2V0KDApO1xuICAgICAgICBjb25zdCBjdHggPSBjYW52YXNFbC5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBjb25zdCBpbWRhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIGNvbHMsIHJvd3MpO1xuICAgICAgICBmb3IgKGxldCByID0gMDsgciA8IHJvd3M7IHIgKz0gMSkge1xuICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgY29sczsgYyArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBpZHggPSAociAqIGNvbHMgKyBjKSAqIDQ7XG4gICAgICAgICAgICBjb25zdCB7IGNvbG9ydmVjIH0gPSBQaWV0LmNvbG9yc1ttYXRyaXhbcl1bY11dO1xuICAgICAgICAgICAgY29uc29sZS5sb2coUGlldCwgUGlldC5jb2xvcnMsIFBpZXQuY29sb3JzW21hdHJpeFtyXVtjXV0sIGNvbG9ydmVjKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgIGltZGF0YS5kYXRhW2lkeCArIGldID0gY29sb3J2ZWNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGN0eC5wdXRJbWFnZURhdGEoaW1kYXRhLCAwLCAwKTtcbiAgICAgICAgY2FudmFzRWwudG9CbG9iKGJsb2IgPT4ge1xuICAgICAgICAgIGNvbnN0IHBuZ1VybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICAgICAgdGhpcy5leHBvcnQucG5nQnV0dG9uLnByb3AoeyBocmVmOiBwbmdVcmwgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjb25zdCBwbmdVcmwgPSBjYW52YXNFbC50b0RhdGFVUkwoJ2ltYWdlL3BuZycpO1xuICAgICAgICAvLyB0aGlzLmV4cG9ydC5wbmdCdXR0b24ucHJvcCh7IGhyZWY6IHBuZ1VybCB9KTtcbiAgICAgICAgY29uc3Qgc3ZnU3RyID0gdGhpcy5jb2RlU3ZnXG4gICAgICAgICAgLm91dGVyU1ZHKClcbiAgICAgICAgICAucmVwbGFjZSgnPHN2ZycsICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIicpO1xuICAgICAgICBjb25zdCBzdmdCbG9iID0gbmV3IEJsb2IoW3N2Z1N0cl0pO1xuICAgICAgICBjb25zdCBzdmdVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN2Z0Jsb2IpO1xuICAgICAgICB0aGlzLmV4cG9ydC5zdmdCdXR0b24ucHJvcCh7IGhyZWY6IHN2Z1VybCB9KTtcbiAgICAgIH0sXG4gICAgfTtcbiAgICAkKCcjbmF2LXNoYXJlLXRhYicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuZXhwb3J0LnVwZGF0ZUV4cG9ydExpbmsoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGlldCB7XG4gIHN0YXRpYyBjb21tYW5kVGV4dCA9IFtcbiAgICBbJycsICcrJywgJy8nLCAnPCcsICdkdXAnLCAnaW5DJ10sXG4gICAgWydwdXNoJywgJy0nLCAnJScsICdEUCsnLCAncm9sbCcsICdvdXROJ10sXG4gICAgWydwb3AnLCAnKicsICchJywgJ0NDKycsICdpbk4nLCAnb3V0QyddLFxuICBdO1xuXG4gIHN0YXRpYyBpbml0aWFsaXplKCkge1xuICAgIHRoaXMuY2hhcjJjb2xvciA9IHt9O1xuICAgIHRoaXMuY29sb3JzID0gW107XG4gICAgY29uc3QgaHVlTWFzayA9IFs0LCA2LCAyLCAzLCAxLCA1XTtcbiAgICBjb25zdCBsaWdodFN0ciA9IFtcbiAgICAgIFsnQzAnLCAnRkYnXSxcbiAgICAgIFsnMDAnLCAnRkYnXSxcbiAgICAgIFsnMDAnLCAnQzAnXSxcbiAgICBdO1xuICAgIGZvciAobGV0IGRhcmtuZXNzID0gMDsgZGFya25lc3MgPCAzOyBkYXJrbmVzcyArPSAxKSB7XG4gICAgICBjb25zdCBsaWdodCA9IGxpZ2h0U3RyW2RhcmtuZXNzXTtcbiAgICAgIGZvciAobGV0IGh1ZSA9IDA7IGh1ZSA8IDY7IGh1ZSArPSAxKSB7XG4gICAgICAgIGNvbnN0IGNoYXJjb2RlID0gZGFya25lc3MgKiAzMiArIGh1ZSArIDQ4O1xuICAgICAgICBsZXQgY29sb3Jjb2RlID0gJyMnO1xuICAgICAgICBjb25zdCBjb2xvcnZlYyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkgKz0gMSkge1xuICAgICAgICAgIGNvbnN0IG5leHRWYWwgPSBsaWdodFsoaHVlTWFza1todWVdID4+ICgyIC0gaSkpICYgMV07XG4gICAgICAgICAgY29sb3Jjb2RlICs9IG5leHRWYWw7XG4gICAgICAgICAgY29sb3J2ZWMucHVzaChOdW1iZXIucGFyc2VJbnQobmV4dFZhbCwgMTYpKTtcbiAgICAgICAgfVxuICAgICAgICBjb2xvcnZlYy5wdXNoKDI1NSk7XG4gICAgICAgIGNvbnN0IGNoYXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXJjb2RlKTtcbiAgICAgICAgdGhpcy5jb2xvcnMucHVzaCh7IGNoYXJjb2RlLCBjaGFyLCBjb2xvcmNvZGUsIGNvbG9ydmVjIH0pO1xuICAgICAgICB0aGlzLmNoYXIyY29sb3JbY2hhcl0gPSBkYXJrbmVzcyAqIDYgKyBodWU7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuY29sb3JzLnB1c2goe1xuICAgICAgY2hhcmNvZGU6ICdAJy5jaGFyQ29kZUF0KCksXG4gICAgICBjaGFyOiAnQCcsXG4gICAgICBjb2xvcmNvZGU6ICcjRkZGRkZGJyxcbiAgICAgIGNvbG9ydmVjOiBbMjU1LCAyNTUsIDI1NSwgMjU1XSxcbiAgICB9KTtcbiAgICB0aGlzLmNoYXIyY29sb3JbJ0AnXSA9IDE4O1xuICAgIHRoaXMuY29sb3JzLnB1c2goe1xuICAgICAgY2hhcmNvZGU6ICcgJy5jaGFyQ29kZUF0KCksXG4gICAgICBjaGFyOiAnICcsXG4gICAgICBjb2xvcmNvZGU6ICcjMDAwMDAwJyxcbiAgICAgIGNvbG9ydmVjOiBbMCwgMCwgMCwgMjU1XSxcbiAgICB9KTtcbiAgICB0aGlzLmNoYXIyY29sb3JbJyAnXSA9IDE5O1xuICB9XG5cbiAgY29uc3RydWN0b3IoY29kZSkge1xuICAgIGNvbnN0IGNvZGVTdHIgPSBjb2RlIHx8ICcwJztcbiAgICB0aGlzLmNvZGUgPSBjb2RlU3RyXG4gICAgICAuc3BsaXQoL1xccj9cXG4vKVxuICAgICAgLm1hcChyb3cgPT4gWy4uLnJvd10ubWFwKGNlbGwgPT4gUGlldC5jaGFyMmNvbG9yW2NlbGxdKSk7XG4gICAgdGhpcy5yb3dzID0gdGhpcy5jb2RlLmxlbmd0aDtcbiAgICB0aGlzLmNvbHMgPSB0aGlzLmNvZGVbMF0ubGVuZ3RoO1xuICB9XG5cbiAgZXh0ZW5kQ29kZShkaXJlY3Rpb24pIHtcbiAgICBpZiAoZGlyZWN0aW9uID09PSAncicpIHtcbiAgICAgIHRoaXMuY29kZS5mb3JFYWNoKHJvdyA9PiB7XG4gICAgICAgIHJvdy5wdXNoKDE5KTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jb2xzICs9IDE7XG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdsJykge1xuICAgICAgdGhpcy5jb2RlLmZvckVhY2gocm93ID0+IHtcbiAgICAgICAgcm93LnVuc2hpZnQoMTkpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbHMgKz0gMTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2QnKSB7XG4gICAgICB0aGlzLmNvZGUucHVzaCh0aGlzLmNvZGVbMF0ubWFwKCgpID0+IDE5KSk7XG4gICAgICB0aGlzLnJvd3MgKz0gMTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3UnKSB7XG4gICAgICB0aGlzLmNvZGUudW5zaGlmdCh0aGlzLmNvZGVbMF0ubWFwKCgpID0+IDE5KSk7XG4gICAgICB0aGlzLnJvd3MgKz0gMTtcbiAgICB9XG4gIH1cblxuICBzaHJpbmtDb2RlKGRpcmVjdGlvbikge1xuICAgIGlmIChcbiAgICAgICgoZGlyZWN0aW9uID09PSAncicgfHwgZGlyZWN0aW9uID09PSAnbCcpICYmIHRoaXMuY29scyA9PT0gMSkgfHxcbiAgICAgICgoZGlyZWN0aW9uID09PSAndScgfHwgZGlyZWN0aW9uID09PSAnZCcpICYmIHRoaXMucm93cyA9PT0gMSlcbiAgICApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdEaW1lbnNpb24gY2Fubm90IGJlIHJlZHVjZWQgZnJvbSAxJyk7XG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdyJykge1xuICAgICAgdGhpcy5jb2RlLmZvckVhY2gocm93ID0+IHtcbiAgICAgICAgcm93LnBvcCgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbHMgLT0gMTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2wnKSB7XG4gICAgICB0aGlzLmNvZGUuZm9yRWFjaChyb3cgPT4ge1xuICAgICAgICByb3cuc2hpZnQoKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jb2xzIC09IDE7XG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdkJykge1xuICAgICAgdGhpcy5jb2RlLnBvcCgpO1xuICAgICAgdGhpcy5yb3dzIC09IDE7XG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICd1Jykge1xuICAgICAgdGhpcy5jb2RlLnNoaWZ0KCk7XG4gICAgICB0aGlzLnJvd3MgLT0gMTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==